<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.16">
<meta name="author" content="Johan Kotlinski, Kevin Lee Reno, Poindexter Frink, Richard Halkyard">
<title>durexForth: Operators Manual</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;-webkit-tap-highlight-color:transparent}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="article">
<div id="header">
<h1>durexForth: Operators Manual</h1>
<div class="details">
<span id="author" class="author">Johan Kotlinski</span><br>
<span id="author2" class="author">Kevin Lee Reno</span><br>
<span id="author3" class="author">Poindexter Frink</span><br>
<span id="author4" class="author">Richard Halkyard</span><br>
<span id="revnumber">version v4.0.0-64-gfa3e4a5,</span>
<span id="revdate">2022-08-21</span>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This manual is for durexForth, a modern Forth system for the Commodore 64.</p>
</div>
</div>
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_introduction">Introduction</a>
<ul class="sectlevel2">
<li><a href="#_why_forth">Why Forth?</a></li>
<li><a href="#_comparing_to_other_forths">Comparing to other Forths</a></li>
<li><a href="#_package_contents">Package Contents</a></li>
</ul>
</li>
<li><a href="#_tutorial">Tutorial</a>
<ul class="sectlevel2">
<li><a href="#_meet_the_interpreter">Meet the Interpreter</a></li>
<li><a href="#_introducing_the_editor">Introducing the Editor</a></li>
<li><a href="#_assembler">Assembler</a></li>
<li><a href="#_console_io_example">Console I/O Example</a></li>
<li><a href="#_printer_example">Printer Example</a></li>
</ul>
</li>
<li><a href="#_editor">Editor</a>
<ul class="sectlevel2">
<li><a href="#_inserting_text">Inserting Text</a></li>
<li><a href="#_navigation">Navigation</a></li>
<li><a href="#_saving_and_quitting">Saving and Quitting</a></li>
<li><a href="#_text_manipulation">Text Manipulation</a></li>
</ul>
</li>
<li><a href="#_forth_words">Forth Words</a>
<ul class="sectlevel2">
<li><a href="#_stack_manipulation">Stack Manipulation</a></li>
<li><a href="#_utility">Utility</a></li>
<li><a href="#_mathematics">Mathematics</a></li>
<li><a href="#_double">Double</a></li>
<li><a href="#_logic">Logic</a></li>
<li><a href="#_memory">Memory</a></li>
<li><a href="#_compiling">Compiling</a></li>
<li><a href="#_word_list">Word List</a></li>
<li><a href="#_variables">Variables</a></li>
<li><a href="#_control_flow">Control Flow</a></li>
<li><a href="#_input">Input</a></li>
<li><a href="#_strings">Strings</a></li>
<li><a href="#_number_formatting">Number Formatting</a></li>
<li><a href="#_vectored_execution">Vectored Execution</a></li>
<li><a href="#_debugging">Debugging</a></li>
<li><a href="#_disk_io">Disk I/O</a></li>
<li><a href="#_compatibility">Compatibility</a></li>
<li><a href="#_kernel_calls">Kernel Calls</a></li>
<li><a href="#_turn_key_utilities">Turn-key Utilities</a></li>
</ul>
</li>
<li><a href="#_graphics_2">Graphics</a>
<ul class="sectlevel2">
<li><a href="#_turtle_graphics">Turtle Graphics</a></li>
<li><a href="#_high_resolution_graphics">High-Resolution Graphics</a></li>
</ul>
</li>
<li><a href="#_sid">SID</a>
<ul class="sectlevel2">
<li><a href="#_voice_control">Voice Control</a></li>
<li><a href="#_sid_control">SID Control</a></li>
</ul>
</li>
<li><a href="#_music_2">Music</a>
<ul class="sectlevel2">
<li><a href="#_music_macro_language">Music Macro Language</a></li>
</ul>
</li>
<li><a href="#_assembler_2">Assembler</a>
<ul class="sectlevel2">
<li><a href="#_variables_3">Variables</a></li>
<li><a href="#_branches">Branches</a></li>
<li><a href="#_labels">Labels</a></li>
</ul>
</li>
<li><a href="#_configuring_durexforth">Configuring durexForth</a>
<ul class="sectlevel2">
<li><a href="#_stripping_modules">Stripping Modules</a></li>
<li><a href="#_custom_start_up">Custom Start-Up</a></li>
<li><a href="#_turn_key_operation">Turn-key Operation</a></li>
</ul>
</li>
<li><a href="#_assembler_mnemonics">Appendix A: Assembler Mnemonics</a></li>
<li><a href="#_memory_map">Appendix B: Memory Map</a></li>
<li><a href="#_word_anatomy">Appendix C: Word Anatomy</a></li>
<li><a href="#_avoiding_stack_crashes">Appendix D: Avoiding Stack Crashes</a></li>
<li><a href="#_internet_resources">Appendix E: Internet Resources</a></li>
<li><a href="#_license">Appendix F: License</a></li>
</ul>
</div>
</div>
<div class="sect1">
<h2 id="_introduction">Introduction</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_why_forth">Why Forth?</h3>
<div class="paragraph">
<p>Forth is a unique language. What is so special about it? It is a small, low-level language, which can easily be extended to a high-level, domain-specific language that does anything you want it to. Compared to C64 Basic, Forth is more attractive in almost every way. It is a lot faster, more memory effective, and more powerful.</p>
</div>
<div class="paragraph">
<p>Compared to C, the nice thing about Forth is that you can run the full development environment on your C64,
with text editor, compiler, assembler and debugger. It makes for a more interactive and fun experience than running a cross-compiler on PC.</p>
</div>
<div class="paragraph">
<p>For a Forth introduction, refer to the excellent <a href="http://www.forth.com/starting-forth/">Starting Forth</a> by Leo Brodie.</p>
</div>
</div>
<div class="sect2">
<h3 id="_comparing_to_other_forths">Comparing to other Forths</h3>
<div class="paragraph">
<p>There are other Forths for C64, most notably Blazin' Forth. Blazin' Forth is excellent, but durexForth has some advantages:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>durexForth uses text files instead of a custom block file system.</p>
</li>
<li>
<p>durexForth is smaller.</p>
</li>
<li>
<p>durexForth is faster.</p>
</li>
<li>
<p>durexForth can boot from cartridge.</p>
</li>
<li>
<p>durexForth implements the Forth 2012 core standard.</p>
</li>
<li>
<p>The durexForth editor is a vi clone.</p>
</li>
<li>
<p>durexForth is open source (available at <a href="https://github.com/jkotlinski/durexforth">Github</a>).</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_package_contents">Package Contents</h3>
<div class="paragraph">
<p>durexForth is packaged as a 16-kByte .crt cartridge file and a .d64 disk image. Booting from cartridge is equivalent to booting from disk, except that cartridge is faster. The disk contains various optional Forth modules, as well as some appetizer demonstration programs, as follows:</p>
</div>
<div class="sect3">
<h4 id="_graphics">Graphics</h4>
<div class="paragraph">
<p>The gfxdemo package demonstrates the high-resolution graphics, with some examples adapted from the book "Step-By-Step Programming C64 Graphics" by Phil Cornes.
Show the demos by entering:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>include gfxdemo</pre>
</div>
</div>
<div class="paragraph">
<p>When an image has finished drawing, press space to continue.</p>
</div>
</div>
<div class="sect3">
<h4 id="_fractals">Fractals</h4>
<div class="paragraph">
<p>The fractals package demonstrates turtle graphics by generating fractal images. Run it by entering:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>include fractals</pre>
</div>
</div>
<div class="paragraph">
<p>When an image has finished drawing, press space to continue.</p>
</div>
</div>
<div class="sect3">
<h4 id="_music">Music</h4>
<div class="paragraph">
<p>The mmldemo package demonstrates the MML music capabilities. To play some music:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>include mmldemo</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_sprites">Sprites</h4>
<div class="paragraph">
<p>The sprite package adds functionality for defining and displaying sprites. To run the demo:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>include spritedemo</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_tutorial">Tutorial</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_meet_the_interpreter">Meet the Interpreter</h3>
<div class="paragraph">
<p>Start up durexForth.
The system will greet you with a blinking yellow cursor, waiting for your input.
This is the interpreter, which allows you to enter Forth code interactively.</p>
</div>
<div class="paragraph">
<p>Let us try the traditional first program: Type in <code>.( Hello, world! )</code> (and press Return).
The system will reply <code>Hello, world! ok</code>.
The <code>ok</code> means that the system is healthy and ready to accept more input.</p>
</div>
<div class="paragraph">
<p>Now, let us try some mathematics.
<code>1 1 +</code> (followed by Return) will add 1 and 1, leaving 2 on the stack.
This can be verified by entering <code>.s</code> to print the stack contents.
Now enter <code>.</code> to pop the 2 and print it to screen, followed by another <code>.s</code> to verify that the stack is empty.</p>
</div>
<div class="paragraph">
<p>Let us define a word <code>bg!</code> for setting the border color&#8230;&#8203;</p>
</div>
<div class="listingblock">
<div class="content">
<pre>: bg! $d020 c! ;</pre>
</div>
</div>
<div class="paragraph">
<p>Now try entering <code>1 bg!</code> to change the border color to white.
Then, try changing it back again with <code>0 bg!</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_introducing_the_editor">Introducing the Editor</h3>
<div class="paragraph">
<p>The v editor is convenient for editing larger pieces of code. With it, you keep an entire source file loaded in RAM, and you can recompile and test it easily.</p>
</div>
<div class="paragraph">
<p>Start the editor by typing <code>v</code>. You will enter the red editor screen. To enter text, first press <code>i</code> to enter insert mode. This mode allows you to insert text into the buffer. You can see that it&#8217;s active on the <code>I</code> that appears in the lower left corner. This is a good start for creating a program!</p>
</div>
<div class="paragraph">
<p>Now, enter the following lines&#8230;&#8203;</p>
</div>
<div class="listingblock">
<div class="content">
<pre>: flash begin 1 $d020 +! again ; flash</pre>
</div>
</div>
<div class="paragraph">
<p>&#8230;&#8203;and then press ← to leave insert mode.
Press <em>F7</em> to compile and run. If everything is entered right, you will see a beautiful color cycle.</p>
</div>
<div class="paragraph">
<p>When you finished watching, press <em>RESTORE</em> to quit your program, then enter <code>v</code> to reopen the editor.</p>
</div>
</div>
<div class="sect2">
<h3 id="_assembler">Assembler</h3>
<div class="paragraph">
<p>If you want to color cycle as fast as possible, it is possible to use the durexForth assembler to generate machine code. <code>code</code> and <code>;code</code> define a code word, just like <code>:</code> and <code>;</code> define Forth words. Within a code word, you can use assembler mnemonics.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>code flash
here ( push current addr )
$d020 inc,
jmp, ( jump to pushed addr )
;code
flash</pre>
</div>
</div>
<div class="paragraph">
<p>It is also possible to use inline assembly within regular Forth words:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>: flash begin [ $d020 inc, ] again ;
flash</pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
As the x register contains the parameter stack depth, your assembly code must leave it unchanged.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_console_io_example">Console I/O Example</h3>
<div class="paragraph">
<p>This piece of code reads from keyboard and sends back the chars to screen:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>: foo key emit recurse ;
foo</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_printer_example">Printer Example</h3>
<div class="paragraph">
<p>This piece of code prints a message to a printer on device #4, and then prints a message to the screen:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>include io

: print-hello
4 device ( use device 4 )
0 0 47 7 open ioabort ( open address 7 as file 47, abort on failure )
47 chkout ioabort ( redirect output to file 47, abort on failure )
." Hello, printer!" cr
clrchn ( stop input and output redirection )
." Hello, screen!" cr
47 close ( close file 47 ) ;

print-hello</pre>
</div>
</div>
<div class="paragraph">
<p>The device number and address may differ between printer models. Commodore MPS series printers use address 0 to print in their uppercase/graphics font, and address 7 to print in their lowercase/uppercase font.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_editor">Editor</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The editor is a vi clone. Launch it by entering v foo in the interpreter (foo being the file you want to edit). You can also enter v without argument to create an unnamed buffer. For more info about vi style editing, see <a href="https://www.vim.org">the Vim web site</a>.</p>
</div>
<div class="sect2">
<h3 id="_inserting_text">Inserting Text</h3>
<div class="paragraph">
<p>At startup, the editor is in command mode. These commands start insert mode, which allows you to enter text. Return to command mode with ←.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">i</dt>
<dd>
<p>Insert text.</p>
</dd>
<dt class="hdlist1">R</dt>
<dd>
<p>Replace text.</p>
</dd>
<dt class="hdlist1">a</dt>
<dd>
<p>Append text.</p>
</dd>
<dt class="hdlist1">A</dt>
<dd>
<p>Append text at end of line.</p>
</dd>
<dt class="hdlist1">C</dt>
<dd>
<p>Change rest of line.</p>
</dd>
<dt class="hdlist1">S</dt>
<dd>
<p>Substitute line.</p>
</dd>
<dt class="hdlist1">s</dt>
<dd>
<p>Substitute character.</p>
</dd>
<dt class="hdlist1">o</dt>
<dd>
<p>Open new line after cursor line.</p>
</dd>
<dt class="hdlist1">O</dt>
<dd>
<p>Open new line on cursor line.</p>
</dd>
<dt class="hdlist1">cw</dt>
<dd>
<p>Change word.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_navigation">Navigation</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">hjkl <em>or</em> ⇐⇑⇓⇒ </dt>
<dd>
<p>Move cursor left, down, up, right.</p>
</dd>
<dt class="hdlist1">-</dt>
<dd>
<p>Scroll 1 line up.</p>
</dd>
<dt class="hdlist1">+</dt>
<dd>
<p>Scroll 1 line down.</p>
</dd>
<dt class="hdlist1">Ctrl+u</dt>
<dd>
<p>Half page up.</p>
</dd>
<dt class="hdlist1">Ctrl+d</dt>
<dd>
<p>Half page down.</p>
</dd>
<dt class="hdlist1">b</dt>
<dd>
<p>Go to previous word.</p>
</dd>
<dt class="hdlist1">w</dt>
<dd>
<p>Go to next word.</p>
</dd>
<dt class="hdlist1">e</dt>
<dd>
<p>Go to end of word.</p>
</dd>
<dt class="hdlist1">fx</dt>
<dd>
<p>Find char x forward.</p>
</dd>
<dt class="hdlist1">Fx</dt>
<dd>
<p>Find char x backward.</p>
</dd>
<dt class="hdlist1">0 <em>or</em> Home</dt>
<dd>
<p>Go to line start.</p>
</dd>
<dt class="hdlist1">$</dt>
<dd>
<p>Go to line end.</p>
</dd>
<dt class="hdlist1">g</dt>
<dd>
<p>Go to start of file.</p>
</dd>
<dt class="hdlist1">G</dt>
<dd>
<p>Go to end of file.</p>
</dd>
<dt class="hdlist1">H</dt>
<dd>
<p>Go to home window line.</p>
</dd>
<dt class="hdlist1">L</dt>
<dd>
<p>Go to last window line.</p>
</dd>
<dt class="hdlist1">M</dt>
<dd>
<p>Go to middle window line.</p>
</dd>
<dt class="hdlist1">/{string}</dt>
<dd>
<p>Search forward for the next occurrence of the string.</p>
</dd>
<dt class="hdlist1">*</dt>
<dd>
<p>Search forward for the next occurrence of the word under the cursor.</p>
</dd>
<dt class="hdlist1">n</dt>
<dd>
<p>Repeat the latest search.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_saving_and_quitting">Saving and Quitting</h3>
<div class="paragraph">
<p>After quitting, the editor can be re-opened by entering v, and it will resume operations with the edit buffer preserved.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">ZZ</dt>
<dd>
<p>Save and exit.</p>
</dd>
<dt class="hdlist1">:q</dt>
<dd>
<p>Exit.</p>
</dd>
<dt class="hdlist1">:w</dt>
<dd>
<p>Save. (Must be followed by return.)</p>
</dd>
<dt class="hdlist1">:w!filename</dt>
<dd>
<p>Save as.</p>
</dd>
<dt class="hdlist1">F7</dt>
<dd>
<p>Compile and run editor contents. On completion, enter v to return to editor. To terminate a running program, press <em>RESTORE</em>.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_text_manipulation">Text Manipulation</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">r</dt>
<dd>
<p>Replace character under cursor.</p>
</dd>
<dt class="hdlist1">x</dt>
<dd>
<p>Delete character.</p>
</dd>
<dt class="hdlist1">X</dt>
<dd>
<p>Backspace-delete character.</p>
</dd>
<dt class="hdlist1">dw</dt>
<dd>
<p>Delete word.</p>
</dd>
<dt class="hdlist1">dd</dt>
<dd>
<p>Cut line.</p>
</dd>
<dt class="hdlist1">D</dt>
<dd>
<p>Delete rest of line.</p>
</dd>
<dt class="hdlist1">yy</dt>
<dd>
<p>Yank (copy) line.</p>
</dd>
<dt class="hdlist1">p</dt>
<dd>
<p>Paste line below cursor position.</p>
</dd>
<dt class="hdlist1">P</dt>
<dd>
<p>Paste line on cursor position.</p>
</dd>
<dt class="hdlist1">J</dt>
<dd>
<p>Join lines.</p>
</dd>
</dl>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_forth_words">Forth Words</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_stack_manipulation">Stack Manipulation</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">drop <em>( a&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Drop top of stack.</p>
</dd>
<dt class="hdlist1">dup <em>( a&#8201;&#8212;&#8201;a a )</em> </dt>
<dd>
<p>Duplicate top of stack.</p>
</dd>
<dt class="hdlist1">swap <em>( a b&#8201;&#8212;&#8201;b a )</em> </dt>
<dd>
<p>Swap top stack elements.</p>
</dd>
<dt class="hdlist1">over <em>( a b&#8201;&#8212;&#8201;a b a )</em> </dt>
<dd>
<p>Make a copy of the second item and push it on top.</p>
</dd>
<dt class="hdlist1">rot <em>( a b c&#8201;&#8212;&#8201;b c a )</em> </dt>
<dd>
<p>Rotate the third item to the top.</p>
</dd>
<dt class="hdlist1">-rot <em>( a b c&#8201;&#8212;&#8201;c a b )</em> </dt>
<dd>
<p>rot rot</p>
</dd>
<dt class="hdlist1">2drop <em>( a b&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Drop two topmost stack elements.</p>
</dd>
<dt class="hdlist1">2dup <em>( a b&#8201;&#8212;&#8201;a b a b )</em> </dt>
<dd>
<p>Duplicate two topmost stack elements.</p>
</dd>
<dt class="hdlist1">?dup <em>( a&#8201;&#8212;&#8201;a a? )</em> </dt>
<dd>
<p>Dup a if a differs from 0.</p>
</dd>
<dt class="hdlist1">nip	<em>( a b&#8201;&#8212;&#8201;b )</em> </dt>
<dd>
<p>swap drop</p>
</dd>
<dt class="hdlist1">tuck <em>( a b&#8201;&#8212;&#8201;b a b )</em> </dt>
<dd>
<p>dup -rot</p>
</dd>
<dt class="hdlist1">pick <em>( x<sub>u</sub> &#8230;&#8203; x<sub>1</sub> x<sub>0</sub> u&#8201;&#8212;&#8201;x<sub>u</sub> &#8230;&#8203; x<sub>1</sub> x<sub>0</sub> x<sub>u</sub> )</em> </dt>
<dd>
<p>Pick from stack element with depth u to top of stack.</p>
</dd>
<dt class="hdlist1">&gt;r <em>( a&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Move value from top of parameter stack to top of return stack.</p>
</dd>
<dt class="hdlist1">r&gt; <em>(&#8201;&#8212;&#8201;a )</em> </dt>
<dd>
<p>Move value from top of return stack to top of parameter stack.</p>
</dd>
<dt class="hdlist1">r@ <em>(&#8201;&#8212;&#8201;a )</em> </dt>
<dd>
<p>Copy value from top of return stack to top of parameter stack.</p>
</dd>
<dt class="hdlist1">depth <em>(&#8201;&#8212;&#8201;n)</em> </dt>
<dd>
<p>n is the number of single-cell values contained in the data stack before n was placed on the stack.</p>
</dd>
<dt class="hdlist1">lsb <em>(&#8201;&#8212;&#8201;addr)</em> </dt>
<dd>
<p>The top address of the LSB parameter stack.</p>
</dd>
<dt class="hdlist1">msb <em>(&#8201;&#8212;&#8201;addr)</em> </dt>
<dd>
<p>The top address of the MSB parameter stack.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_utility">Utility</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">. <em>( n&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Print top value of stack as signed number.</p>
</dd>
<dt class="hdlist1">u. <em>( u&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Print top value of stack as unsigned number.</p>
</dd>
<dt class="hdlist1">.s </dt>
<dd>
<p>See stack contents.</p>
</dd>
<dt class="hdlist1">emit <em>( a&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Print top value of stack as a PETSCII character. Example: <code>q emit</code></p>
</dd>
<dt class="hdlist1">£ </dt>
<dd>
<p>Comment to end of line. (Used on C64/PETSCII.)</p>
</dd>
<dt class="hdlist1">\ </dt>
<dd>
<p>Comment to end of line. (Used when cross-compiling from PC/ASCII.)</p>
</dd>
<dt class="hdlist1">( </dt>
<dd>
<p>Multiline comment. Ignores everything until a <code>)</code>.</p>
</dd>
<dt class="hdlist1">bl <em>(&#8201;&#8212;&#8201;char )</em> </dt>
<dd>
<p><em>char</em> is the PETSCII character for a space.</p>
</dd>
<dt class="hdlist1">space </dt>
<dd>
<p>Display one space.</p>
</dd>
<dt class="hdlist1">spaces <em>( n&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Display <em>n</em> spaces.</p>
</dd>
<dt class="hdlist1">page </dt>
<dd>
<p>Clears the screen.</p>
</dd>
<dt class="hdlist1">rvs </dt>
<dd>
<p>Reverse screen output.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_mathematics">Mathematics</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">1+ <em>( a&#8201;&#8212;&#8201;b )</em> </dt>
<dd>
<p>Increase top of stack value by 1.</p>
</dd>
<dt class="hdlist1">1- <em>( a&#8201;&#8212;&#8201;b )</em> </dt>
<dd>
<p>Decrease top of stack value by 1.</p>
</dd>
<dt class="hdlist1">2+ <em>( a&#8201;&#8212;&#8201;b )</em> </dt>
<dd>
<p>Increase top of stack value by 2.</p>
</dd>
<dt class="hdlist1">2* <em>( a&#8201;&#8212;&#8201;b )</em> </dt>
<dd>
<p>Multiply top of stack value by 2.</p>
</dd>
<dt class="hdlist1">2/ <em>( a&#8201;&#8212;&#8201;b )</em> </dt>
<dd>
<p>Divide top of stack value by 2.</p>
</dd>
<dt class="hdlist1">100/ <em>( a&#8201;&#8212;&#8201;b )</em> </dt>
<dd>
<p>Divides top of stack value by $100.</p>
</dd>
<dt class="hdlist1">+! <em>( n a&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Add n to memory address a.</p>
</dd>
<dt class="hdlist1">+ <em>( a b&#8201;&#8212;&#8201;c )</em> </dt>
<dd>
<p>Add a and b.</p>
</dd>
<dt class="hdlist1">- <em>( a b&#8201;&#8212;&#8201;c )</em> </dt>
<dd>
<p>Subtract b from a.</p>
</dd>
<dt class="hdlist1">* <em>( a b&#8201;&#8212;&#8201;c )</em> </dt>
<dd>
<p>Multiply a with b.</p>
</dd>
<dt class="hdlist1">/ <em>( a b&#8201;&#8212;&#8201;q )</em> </dt>
<dd>
<p>Divide a with b using floored division.</p>
</dd>
<dt class="hdlist1">/mod <em>( a b&#8201;&#8212;&#8201;r q )</em> </dt>
<dd>
<p>Divide a with b, giving remainder r and quotient q.</p>
</dd>
<dt class="hdlist1">mod <em>( a b&#8201;&#8212;&#8201;r )</em> </dt>
<dd>
<p>Remainder of a divided by b.</p>
</dd>
<dt class="hdlist1">*/ <em>( a b c&#8201;&#8212;&#8201;q )</em> </dt>
<dd>
<p>Multiply a with b, then divide by c, using a 32-bit intermediary.</p>
</dd>
<dt class="hdlist1">*/mod <em>( a b c&#8201;&#8212;&#8201;r q )</em> </dt>
<dd>
<p>Like */, but also keeping remainder r.</p>
</dd>
<dt class="hdlist1">0&lt; <em>( a&#8201;&#8212;&#8201;b )</em> </dt>
<dd>
<p>Is a negative?</p>
</dd>
<dt class="hdlist1">negate <em>( a&#8201;&#8212;&#8201;b )</em> </dt>
<dd>
<p>Negate a.</p>
</dd>
<dt class="hdlist1">abs <em>( a&#8201;&#8212;&#8201;b )</em> </dt>
<dd>
<p>Give absolute value of a.</p>
</dd>
<dt class="hdlist1">min <em>( a b&#8201;&#8212;&#8201;c )</em> </dt>
<dd>
<p>Give the lesser of a and b.</p>
</dd>
<dt class="hdlist1">max <em>( a b&#8201;&#8212;&#8201;c )</em> </dt>
<dd>
<p>Give the greater of a and b.</p>
</dd>
<dt class="hdlist1">within <em>( n lo hi&#8201;&#8212;&#8201;flag )</em> </dt>
<dd>
<p>Return true if lo ≤ n &lt; hi.</p>
</dd>
<dt class="hdlist1">&lt; <em>( n1 n2&#8201;&#8212;&#8201;flag )</em> </dt>
<dd>
<p>Is n1 less than n2? (Signed.)</p>
</dd>
<dt class="hdlist1">&gt; <em>( n1 n2&#8201;&#8212;&#8201;flag )</em> </dt>
<dd>
<p>Is n1 greater than n2? (Signed.)</p>
</dd>
<dt class="hdlist1">u&lt; <em>( u1 u2&#8201;&#8212;&#8201;flag )</em> </dt>
<dd>
<p>Is u1 less than u2? (Unsigned.)</p>
</dd>
<dt class="hdlist1">u&gt; <em>( u1 u2&#8201;&#8212;&#8201;flag )</em> </dt>
<dd>
<p>Is u1 greater than u2? (Unsigned.)</p>
</dd>
<dt class="hdlist1">lshift <em>( a b&#8201;&#8212;&#8201;c )</em> </dt>
<dd>
<p>Binary shift a left by b.</p>
</dd>
<dt class="hdlist1">rshift <em>( a b&#8201;&#8212;&#8201;c )</em> </dt>
<dd>
<p>Binary shift a right by b.</p>
</dd>
<dt class="hdlist1">base <em>(&#8201;&#8212;&#8201;addr )</em> </dt>
<dd>
<p><em>addr</em> is the address of a cell that holds the numerical base.</p>
</dd>
<dt class="hdlist1">decimal </dt>
<dd>
<p>Set the numerical base to 10.</p>
</dd>
<dt class="hdlist1">hex </dt>
<dd>
<p>Set the numerical base to 16.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_double">Double</h3>
<div class="paragraph">
<p>The following words use double-cell integers. On the stack, the cell containing the most significant part of a double-cell integer is above the cell containing the least significant part.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">dabs <em>( d&#8201;&#8212;&#8201;ud )</em> </dt>
<dd>
<p>Produce the absolute value of <em>d</em>.</p>
</dd>
<dt class="hdlist1">dnegate <em>( d&#8201;&#8212;&#8201;d )</em> </dt>
<dd>
<p>Negate the double-cell integer <em>d</em>.</p>
</dd>
<dt class="hdlist1">s&gt;d <em>( n&#8201;&#8212;&#8201;d )</em> </dt>
<dd>
<p>Convert the number n to the double-cell number <em>d</em>.</p>
</dd>
<dt class="hdlist1">m+ <em>( d n&#8201;&#8212;&#8201;d )</em> </dt>
<dd>
<p>Add <em>n</em> to double-cell number <em>d</em>.</p>
</dd>
<dt class="hdlist1">m* <em>( a b&#8201;&#8212;&#8201;d )</em> </dt>
<dd>
<p>Multiply <em>a</em> with <em>b</em>, producing a double-cell value.</p>
</dd>
<dt class="hdlist1">um* <em>( a b&#8201;&#8212;&#8201;ud )</em> </dt>
<dd>
<p>Multiply <em>a</em> with <em>b</em>, giving the unsigned double-cell number <em>ud</em>.</p>
</dd>
<dt class="hdlist1">um/mod <em>( ud n&#8201;&#8212;&#8201;r q )</em> </dt>
<dd>
<p>Divide double-cell number ud by n, giving remainder r and quotient q. Values are unsigned.</p>
</dd>
<dt class="hdlist1">fm/mod <em>( d n&#8201;&#8212;&#8201;r q )</em> </dt>
<dd>
<p>Divide double-cell number d by n, giving the floored quotient q and the remainder r. Values are signed.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_logic">Logic</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">0= <em>( a&#8201;&#8212;&#8201;flag)</em> </dt>
<dd>
<p>Is <em>a</em> equal to zero?</p>
</dd>
<dt class="hdlist1">0&lt;&gt; <em>( a&#8201;&#8212;&#8201;flag )</em> </dt>
<dd>
<p>Is <em>a</em> not equal to 0?</p>
</dd>
<dt class="hdlist1">= <em>( a b&#8201;&#8212;&#8201;flag )</em> </dt>
<dd>
<p>Is <em>a</em> equal to <em>b</em>?</p>
</dd>
<dt class="hdlist1">&lt;&gt; <em>( a b&#8201;&#8212;&#8201;flag )</em> </dt>
<dd>
<p>Does <em>a</em> differ from <em>b</em>?</p>
</dd>
<dt class="hdlist1">and <em>( a b&#8201;&#8212;&#8201;c )</em> </dt>
<dd>
<p>Binary and.</p>
</dd>
<dt class="hdlist1">or <em>( a b&#8201;&#8212;&#8201;c )</em> </dt>
<dd>
<p>Binary or.</p>
</dd>
<dt class="hdlist1">xor <em>( a b&#8201;&#8212;&#8201;c )</em> </dt>
<dd>
<p>Binary exclusive or.</p>
</dd>
<dt class="hdlist1">invert <em>( a&#8201;&#8212;&#8201;b )</em> </dt>
<dd>
<p>Flip all bits of <em>a</em>.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_memory">Memory</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">! <em>( value address&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Store 16-bit value at address.</p>
</dd>
<dt class="hdlist1">@ <em>( address&#8201;&#8212;&#8201;value )</em> </dt>
<dd>
<p>Fetch 16-bit value from address.</p>
</dd>
<dt class="hdlist1">c! <em>( value address&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Store 8-bit value at address.</p>
</dd>
<dt class="hdlist1">c@ <em>( address&#8201;&#8212;&#8201;value )</em> </dt>
<dd>
<p>Fetch 8-bit value from address.</p>
</dd>
<dt class="hdlist1">fill <em>( addr len char&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Fill range [addr, len + addr) with char.</p>
</dd>
<dt class="hdlist1">move <em>( src dst len&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Copies a region of memory <code>len</code> bytes long, starting at <code>src</code>, to memory beginning at <code>dst</code>.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_compiling">Compiling</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">: <em>( "name"&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Define the word with the given name and enter compilation state.</p>
</dd>
<dt class="hdlist1">:noname <em>(&#8201;&#8212;&#8201;xt )</em> </dt>
<dd>
<p>Create an execution token and enter compilation state.</p>
</dd>
<dt class="hdlist1">; <em>(&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>End the current definition, allow it to be found in the dictionary and go back to interpretation state.</p>
</dd>
<dt class="hdlist1">code <em>( "name"&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Start assembling a new word.</p>
</dd>
<dt class="hdlist1">;code  </dt>
<dd>
<p>End assembler.</p>
</dd>
<dt class="hdlist1">, <em>( n&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Write word on stack to <code>here</code> position and increase <code>here</code> by 2.</p>
</dd>
<dt class="hdlist1">c, <em>( n&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Write byte on stack to <code>here</code> position and increase <code>here</code> by 1.</p>
</dd>
<dt class="hdlist1">allot <em>( n&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Add <em>n</em> bytes to the body of the most recently defined word.</p>
</dd>
<dt class="hdlist1">literal <em>( n&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Compile a value from the stack as a literal value. Typical use: <code>: x &#8230;&#8203; [ a b * ] literal &#8230;&#8203; ;</code></p>
</dd>
<dt class="hdlist1">[char] <em>( "c"&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Compile character <em>c</em> as a literal value.</p>
</dd>
<dt class="hdlist1">[ <em>(&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Leave compile mode. Execute the following words immediately instead of compiling them.</p>
</dd>
<dt class="hdlist1">] <em>(&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Return to compile mode.
immediate:: Mark the most recently defined word as immediate (i.e. inside colon definitions, it will be executed immediately instead of compiled).</p>
</dd>
<dt class="hdlist1">['] name <em>(&#8201;&#8212;&#8201;xt )</em></dt>
<dd>
<p>Place name&#8217;s execution token xt on the stack.
The execution token returned by the compiled phrase ['] x is the same value returned by ' x outside of compilation state.
Typical use: : x ... ['] name ... ;</p>
</dd>
<dt class="hdlist1">compile, ( xt&#8201;&#8212;&#8201;) </dt>
<dd>
<p>Append <code>jsr xt</code> to the word being compiled. Typical use: : recurse immed latest &gt;xt compile, ;</p>
</dd>
<dt class="hdlist1">postpone <em>xxx</em> </dt>
<dd>
<p>Compile the compilation semantics (instead of interpretation semantics) of xxx. Typical use:</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre>: endif postpone then ; immediate
: x ... if ... endif ... ;</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">header <em>( "name"&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Create a dictionary header named <em>name</em>.</p>
</dd>
<dt class="hdlist1">create <em>( "name"&#8201;&#8212;&#8201;)</em> &#8230;&#8203; does&gt; </dt>
<dd>
<p>Create a word-creating word named <em>name</em> with custom behavior specified after <code>does&gt;</code>.  For further description, see "Starting Forth."</p>
</dd>
<dt class="hdlist1">state <em>(&#8201;&#8212;&#8201;addr)</em> </dt>
<dd>
<p><em>addr</em> is the address of a cell containing the compilation-state flag. It is 1 when compiling, otherwise 0.</p>
</dd>
<dt class="hdlist1">latest <em>(&#8201;&#8212;&#8201;value )</em> </dt>
<dd>
<p>Address of the latest defined header.</p>
</dd>
<dt class="hdlist1">here <em>(&#8201;&#8212;&#8201;value )</em> </dt>
<dd>
<p>Write position of the Forth compiler (usually first unused byte of code space).
Many C64 assemblers refer to this as program counter or '*'.</p>
</dd>
<dt class="hdlist1">marker <em>( "name"&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Create a word that when called, forgets itself and all words that were defined after it. Example:</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre>marker forget
: x ; forget</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_word_list">Word List</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">hide <em>( "name"&#8201;&#8212;&#8201;)</em></dt>
<dd>
<p>Remove <em>name</em> from the word list, while leaving its definition in place.</p>
</dd>
<dt class="hdlist1">define <em>( "name"&#8201;&#8212;&#8201;)</em></dt>
<dd>
<p>Assign <code>here</code> as the execution token of word <em>name</em> and enter the compilation state.</p>
</dd>
<dt class="hdlist1">defcode <em>( "name"&#8201;&#8212;&#8201;)</em></dt>
<dd>
<p>Like <code>define</code>, but starts a <code>code</code> segment instead.</p>
</dd>
<dt class="hdlist1">dowords <em>( xt&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Execute <em>xt</em> once for every word in the word list, passing the name token of the word to <em>xt</em>, until the word list is exhausted or <em>xt</em> returns false. The invoked <em>xt</em> has the stack effect <em>( k * x nt&#8201;&#8212;&#8201;l * x flag )</em>. If <em>flag</em> is true, <code>dowords</code> will continue on to the next name, otherwise it will return.</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre>\ from debug.fs
: (words) more name&gt;string space 1 ;
: words ['] (words) dowords ;</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_variables">Variables</h3>
<div class="sect3">
<h4 id="_values">Values</h4>
<div class="paragraph">
<p>Values are fast to read, slow to write.
Use values for variables that are rarely changed.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><em>1</em> value <em>foo</em></dt>
<dd>
<p>Create value <em>foo</em> and set it to <em>1</em>.</p>
</dd>
<dt class="hdlist1"><em>2</em> constant <em>bar</em></dt>
<dd>
<p>Create constant value <em>bar</em> and set it to <em>2</em>.</p>
</dd>
<dt class="hdlist1"><em>foo</em></dt>
<dd>
<p>Fetch value of <em>foo</em>.</p>
</dd>
<dt class="hdlist1"><em>0</em> to <em>foo</em></dt>
<dd>
<p>Set <em>foo</em> to <em>0</em>.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="_variables_2">Variables</h4>
<div class="paragraph">
<p>Variables are faster to write to than values.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">variable <em>bar</em></dt>
<dd>
<p>Define variable <em>bar</em>.</p>
</dd>
<dt class="hdlist1"><em>bar</em> @</dt>
<dd>
<p>Fetch value of variable <em>bar</em>.</p>
</dd>
<dt class="hdlist1"><em>1 bar</em> !</dt>
<dd>
<p>Set variable <em>bar</em> to <em>1</em>.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_control_flow">Control Flow</h3>
<div class="paragraph">
<p>Control functions only work in compile mode, not in interpreter.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">if &#8230;&#8203; then </dt>
<dd>
<p>condition IF true-part THEN rest</p>
</dd>
<dt class="hdlist1">if &#8230;&#8203; else &#8230;&#8203; then </dt>
<dd>
<p>condition IF true-part ELSE false-part THEN rest</p>
</dd>
<dt class="hdlist1">do .. loop </dt>
<dd>
<p>Start a loop with index and limit. Example:</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre>: print0to7 8 0 do i . loop ;</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">do .. +loop </dt>
<dd>
<p>Start a loop with a custom increment. Example:</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre>( prints odd numbers from 1 to n )
: printoddnumbers (n -- ) 1 do i . 2 +loop ;</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">i, j </dt>
<dd>
<p>Variables to be used inside <code>do</code> .. <code>loop</code> constructs. <code>i</code> gives inner loop index, <code>j</code> gives outer loop index.</p>
</dd>
<dt class="hdlist1">leave </dt>
<dd>
<p>Leave the innermost loop.</p>
</dd>
<dt class="hdlist1">unloop </dt>
<dd>
<p>Discard the loop-control parameters. Allows clean <a href="#exit">((exit)) </a> from within a loop.</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre>: x 0 0 do unloop exit loop ;</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">begin .. again </dt>
<dd>
<p>Infinite loop.</p>
</dd>
<dt class="hdlist1">begin .. until </dt>
<dd>
<p>BEGIN loop-part condition UNTIL. Loop until condition is true.</p>
</dd>
<dt class="hdlist1">begin .. while .. repeat </dt>
<dd>
<p>BEGIN condition WHILE loop-part REPEAT. Repeat loop-part while condition is true.</p>
</dd>
<dt class="hdlist1"><a id="exit"></a> exit </dt>
<dd>
<p>Exit function. Typical use: <code>: X test IF EXIT THEN &#8230;&#8203; ;</code></p>
</dd>
<dt class="hdlist1">recurse </dt>
<dd>
<p>Jump to the start of the word being compiled.</p>
</dd>
<dt class="hdlist1">case .. endcase, of .. endof </dt>
<dd>
<p>Switch statements.</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre>: tellno ( n -- )
case
1 of ." one" endof
2 of ." two" endof
3 of ." three" endof
     ." other" endcase ;</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_input">Input</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">key <em>(&#8201;&#8212;&#8201;c )</em> </dt>
<dd>
<p>Get one character from the keyboard.</p>
</dd>
<dt class="hdlist1">key? <em>(&#8201;&#8212;&#8201;flag )</em> </dt>
<dd>
<p>Return true if a character is available for <code>key</code>.</p>
</dd>
<dt class="hdlist1">getc <em>(&#8201;&#8212;&#8201;c )</em> </dt>
<dd>
<p>Consume the next character from the input buffer and increases <code>&gt;in</code> by one. If no characters are available, the input buffer is refilled as needed.</p>
</dd>
<dt class="hdlist1">char <em>(&#8201;&#8212;&#8201;c )</em> </dt>
<dd>
<p>Parse the next word, delimited by a space, and puts its first character on the stack.</p>
</dd>
<dt class="hdlist1">&gt;in <em>(&#8201;&#8212;&#8201;addr )</em> </dt>
<dd>
<p>Give the address of a cell containing the offset in characters from the start of the input buffer to the start of the parse area.</p>
</dd>
<dt class="hdlist1">refill <em>(&#8201;&#8212;&#8201;flag )</em> </dt>
<dd>
<p>Attempt to fill the input buffer from the input source, returning true if successful.</p>
</dd>
<dt class="hdlist1">source <em>(&#8201;&#8212;&#8201;caddr u )</em> </dt>
<dd>
<p>Give the address of, and number of characters in, the input buffer.</p>
</dd>
<dt class="hdlist1">source-id <em>(&#8201;&#8212;&#8201;n )</em> </dt>
<dd>
<p>Return 0 if current input is keyboard, -1 if it is a string from <code>evaluate</code>, or the current file id.</p>
</dd>
<dt class="hdlist1">word <em>( delim&#8201;&#8212;&#8201;addr )</em> </dt>
<dd>
<p>Read a word from input, using delimiter <em>delim</em>, and puts the string address on the stack. If the delimiter is the space character, non-breaking space (hex a0) will also be treated as a delimiter.</p>
</dd>
<dt class="hdlist1">parse-name <em>( name&#8201;&#8212;&#8201;caddr u )</em> </dt>
<dd>
<p>Read a word from input, delimited by whitespace. Skips leading spaces.</p>
</dd>
<dt class="hdlist1">interpret <em>(&#8201;&#8212;&#8201;value )</em> </dt>
<dd>
<p>Interpret a word from input and puts it on the stack.</p>
</dd>
<dt class="hdlist1">accept <em>( addr u&#8201;&#8212;&#8201;u )</em> </dt>
<dd>
<p>Receive a string of at most u characters into the buffer that starts at addr. Return how many characters were received.</p>
</dd>
<dt class="hdlist1">evaluate <em>( addr len&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Evaluate the given string.</p>
</dd>
<dt class="hdlist1">abort </dt>
<dd>
<p>Clear the data stack and perform <code>quit</code>.</p>
</dd>
<dt class="hdlist1">abort" <em>ccc" ( f&#8201;&#8212;&#8201;)</em>  </dt>
<dd>
<p>If <em>f</em> is true, print <em>ccc</em> and <code>abort</code>. Typical use: <code>: x &#8230;&#8203; test abort" error" &#8230;&#8203; ;</code></p>
</dd>
<dt class="hdlist1">quit </dt>
<dd>
<p>Enter an endless loop where DurexForth interprets Forth commands from the keyboard. The word is named "quit" since it can be used to quit a program. It also does cleanup tasks like resetting I/O.</p>
</dd>
<dt class="hdlist1">pad <em>(&#8201;&#8212;&#8201;addr )</em> </dt>
<dd>
<p><em>addr</em> is the address of the <code>pad</code>, a 161-byte memory region that can be used freely by user words.
No built-in words will modify this region.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_strings">Strings</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">.( </dt>
<dd>
<p>Print a string. Example: <code>.( foo)</code></p>
</dd>
<dt class="hdlist1">." </dt>
<dd>
<p>Compile-time version of <code>.(</code>. Example: <code>: foo ." bar" ;</code></p>
</dd>
<dt class="hdlist1">s" <em>(&#8201;&#8212;&#8201;caddr u )</em> </dt>
<dd>
<p>Define a string. Compile-time only! Example: <code>s" foo"</code>.</p>
</dd>
<dt class="hdlist1">count <em>( str&#8201;&#8212;&#8201;caddr u )</em> </dt>
<dd>
<p>Return data address and length of the counted string <em>str</em>.</p>
</dd>
<dt class="hdlist1">type <em>( caddr u&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Print a string.</p>
</dd>
<dt class="hdlist1">/string <em>( caddr u n&#8201;&#8212;&#8201;caddr+n u-n )</em> </dt>
<dd>
<p>Adjust the string by <em>n</em> characters.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_number_formatting">Number Formatting</h3>
<div class="paragraph">
<p>For more info about number formatting, read Starting Forth.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">&lt;# </dt>
<dd>
<p>Begin the number conversion process.</p>
</dd>
<dt class="hdlist1"># <em>( ud&#8201;&#8212;&#8201;ud )</em> </dt>
<dd>
<p>Convert one digit and puts it in the start of the output string.</p>
</dd>
<dt class="hdlist1">#s <em>( ud&#8201;&#8212;&#8201;ud )</em> </dt>
<dd>
<p>Call <code>#</code> and repeats until <em>ud</em> is zero.</p>
</dd>
<dt class="hdlist1">hold <em>( ch&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Insert the character <code>ch</code> at the start of the output string.</p>
</dd>
<dt class="hdlist1">sign <em>( a&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>If <em>a</em> is negative, insert a minus sign at the start of the output string.</p>
</dd>
<dt class="hdlist1">#&gt; <em>( xd&#8201;&#8212;&#8201;addr u )</em> </dt>
<dd>
<p>Drop <em>xd</em> and returns the output string.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_vectored_execution">Vectored Execution</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">' <em>( "name"&#8201;&#8212;&#8201;addr )</em> </dt>
<dd>
<p>Find execution token of the word named <em>name</em>.</p>
</dd>
<dt class="hdlist1">find <em>( cstr&#8201;&#8212;&#8201;cstr 0 | xt -1 | xt 1 )</em> </dt>
<dd>
<p>Find the definition named in the counted string <em>cstr</em>.
If the definition is not found, return <em>cstr</em> and 0, otherwise return the execution token.
If the definition is immediate, also return 1, otherwise also return -1.</p>
</dd>
<dt class="hdlist1">find-name <em>( caddr u&#8201;&#8212;&#8201;0 | nt )</em> </dt>
<dd>
<p>Get the name token (dictionary pointer) of the word named by <em>caddr u</em>, or 0 if the word is not found.</p>
</dd>
<dt class="hdlist1">execute <em>( xt&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Execute the execution token <em>xt</em>.</p>
</dd>
<dt class="hdlist1">&gt;xt <em>( addr&#8201;&#8212;&#8201;xt )</em> </dt>
<dd>
<p>Get execution token of word at adress <em>addr</em>.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_debugging">Debugging</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">words </dt>
<dd>
<p>List all defined words.</p>
</dd>
<dt class="hdlist1">size <em>( "name"&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Print the size of the definition of the word named <em>name</em>.</p>
</dd>
<dt class="hdlist1">dump <em>( n&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Memory dump starting at address <em>n</em>.</p>
</dd>
<dt class="hdlist1">n </dt>
<dd>
<p>Continue memory dump where last one stopped.</p>
</dd>
<dt class="hdlist1">see <em>( "name"&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Print the definition of the word named <em>name</em>. Works on colon definitions only. Optionally included with <code>include see</code>.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_disk_io">Disk I/O</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">include <em>( "filename"&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Load and parse file. Example: <code>include test</code></p>
</dd>
<dt class="hdlist1">included <em>( filenameptr filenamelen&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Load and parse file.</p>
</dd>
<dt class="hdlist1">require <em>( "filename"&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Like include, except that load is skipped if the file is already loaded.</p>
</dd>
<dt class="hdlist1">required <em>( filenameptr filenamelen&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Like included, except that load is skipped if the file is already loaded.</p>
</dd>
<dt class="hdlist1">loadb <em>( filenameptr filenamelen dst&#8201;&#8212;&#8201;endaddr )</em> </dt>
<dd>
<p>Load binary data to <em>dst</em>.
Returns 0 on failure, otherwise address after last written byte.</p>
</dd>
<dt class="hdlist1">saveb <em>( start end filenameptr filenamelength&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Save binary data.</p>
</dd>
<dt class="hdlist1">device <em>( device#&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Switch the active device.</p>
</dd>
<dt class="hdlist1">save-forth <em>( "filename"&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Save the forth to the given filename.</p>
</dd>
<dt class="hdlist1">ls </dt>
<dd>
<p>Load and print disk directory with optional drive # and wildcards. Example: <code>ls $1:*=p</code> Load directory for drive 1, only prg files.</p>
</dd>
<dt class="hdlist1">rdir <em>( addr&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Display disk directory previously loaded to addr.</p>
</dd>
</dl>
</div>
<div class="sect3">
<h4 id="_dos_commands">DOS Commands</h4>
<div class="paragraph">
<p>Words for sending DOS commands to drives and reading drive status are available by including the <code>dos</code> module.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">send-cmd <em>( c-addr u&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Write the given string to secondary address 15 on the current device, and print the drive&#8217;s response. The following example defines a word, <code>backup</code> that creates a copy of <code>durexforth</code> called <code>backup</code>:</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre>: backup s" copy0:backup=durexforth" send-cmd ;
backup</pre>
</div>
</div>
<div class="paragraph">
<p>dos ( "cmd"&#8201;&#8212;&#8201;)] Send <em>cmd</em> to the current device&#8217;s command channel, and print the response. Note that the remainder of the line is treated as part of the command. This makes it possible to refer to file names that contain spaces, but means that <code>dos</code> and its command should be on their own line, or the last words on a line. Example: <code>dos scratch0:old file</code> will delete a file named <em>old file</em>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_low_level_device_io">Low-Level Device I/O</h4>
<div class="paragraph">
<p>For more advanced uses, words corresponding to the standard Commodore Kernal IO routines are available by including the <code>io</code> module.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">open <em>( filenameptr filenamelength file# secondary-addr&#8201;&#8212;&#8201;ioresult )</em> </dt>
<dd>
<p>Open a logical file.</p>
</dd>
<dt class="hdlist1">chkin <em>( file#&#8201;&#8212;&#8201;ioresult )</em> </dt>
<dd>
<p>Use a logical file as input device.</p>
</dd>
<dt class="hdlist1">chkout <em>( file#&#8201;&#8212;&#8201;ioresult )</em> </dt>
<dd>
<p>Use a logical file as output device.</p>
</dd>
<dt class="hdlist1">clrchn <em>(&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Reset input and output to the keyboard and screen.</p>
</dd>
<dt class="hdlist1">close <em>( file#&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Close a logical file.</p>
</dd>
<dt class="hdlist1">readst <em>(&#8201;&#8212;&#8201;status )</em> </dt>
<dd>
<p>Return the status of the last IO operation.
For serial-bus devices, <code>$01</code> = write timeout, <code>$02</code> = read timeout, <code>$40</code> = end of file (EOI), <code>$80</code> = device not present.</p>
</dd>
<dt class="hdlist1">chrin <em>(&#8201;&#8212;&#8201;char)</em> </dt>
<dd>
<p>Read a character from the current input device.
ioabort <em>( ioresult&#8201;&#8212;&#8201;)</em> Handle error conditions for <code>open</code>, <code>chkin</code> and <code>chkout</code>. On failure, print error message and abort.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>As per the underlying Kernal routines, <code>chrin</code> does not check for end-of-file or any other error condition. <code>readst</code> should be called to ensure that the returned character is valid.</p>
</div>
<div class="paragraph">
<p>The <em>ioresult</em> value returned by <code>open</code>, <code>chkin</code> and <code>chkout</code> is 0 on success, or a Kernal error number if an error occurred.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Low-level device I/O may interfere with disk accesses done by durexForth and the <code>v</code> editor. The following guidelines should be followed to avoid interference:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Avoid using file numbers 15 and below (remember, any number up to 127 can be used as a file number).</p>
</li>
<li>
<p>Only use input/output redirection (<code>chkin</code> and <code>chkout</code>) within word definitions, and ensure that <code>clrchn</code> is called before exit.</p>
</li>
<li>
<p>Close files as soon as they are no longer needed.</p>
</li>
<li>
<p>If multiple files are open, always call <code>clrchn</code> to end any serial bus transactions before calling <code>open</code> or switching between files with <code>chkin</code> or <code>chkout</code>.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_compatibility">Compatibility</h3>
<div class="paragraph">
<p>The <code>compat</code> module contains various words that are not deemed necessary for enjoyable DurexForth operation, but still must be provided to comply with the Forth 2012 core standard.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">environment? <em>( addr u&#8201;&#8212;&#8201;0 )</em> </dt>
<dd>
<p>Environmental query.</p>
</dd>
<dt class="hdlist1">cell+ <em>( n&#8201;&#8212;&#8201;n+2 )</em> </dt>
<dd>
<p>2+</p>
</dd>
<dt class="hdlist1">cells <em>( n&#8201;&#8212;&#8201;n*2 )</em> </dt>
<dd>
<p>2*</p>
</dd>
<dt class="hdlist1">char+ <em>( n&#8201;&#8212;&#8201;n+1 )</em> </dt>
<dd>
<p>1+</p>
</dd>
<dt class="hdlist1">align <em>(&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>No-op</p>
</dd>
<dt class="hdlist1">aligned <em>(&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>No-op</p>
</dd>
<dt class="hdlist1">chars <em>(&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>No-op</p>
</dd>
<dt class="hdlist1">2@ <em>( addr&#8201;&#8212;&#8201;x1 x2 )</em> </dt>
<dd>
<p>Fetch 32-bit value from <em>addr</em>. <em>x2</em> is stored at <em>addr</em>, and <em>x1</em> is stored at <em>addr</em> + 2.</p>
</dd>
<dt class="hdlist1">2! <em>( x1 x2 addr&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Store 32-bit value to <em>addr</em>. <em>x2</em> is stored at <em>addr</em>, and <em>x1</em> is stored at <em>addr</em> + 2.</p>
</dd>
<dt class="hdlist1">2over <em>( a b c d&#8201;&#8212;&#8201;a b c d a b )</em> </dt>
<dd>
<p>Copy cell pair <em>a</em> <em>b</em> to top of stack.</p>
</dd>
<dt class="hdlist1">2swap <em>( a b c d&#8201;&#8212;&#8201;c d a b )</em> </dt>
<dd>
<p>Exchange the top two cell pairs.</p>
</dd>
<dt class="hdlist1">&gt;number <em>( ud addr u&#8201;&#8212;&#8201;ud addr2 u2 )</em> </dt>
<dd>
<p>Convert the string in <em>addr u</em> to digits, using <code>base</code>, and adds each digit into <em>ud</em> after multiplying it with <code>base</code>. <em>addr2 u2</em> contains the part of the string that was not converted.</p>
</dd>
<dt class="hdlist1">&gt;body <em>( xt&#8201;&#8212;&#8201;addr )</em> </dt>
<dd>
<p>Return the data field address that belongs to the execution token. Example use: <code>' foo &gt;body</code></p>
</dd>
<dt class="hdlist1">sm/rem <em>( d n&#8201;&#8212;&#8201;r q )</em> </dt>
<dd>
<p>Divide double-cell number <em>d</em> by <em>n</em>, giving the symmetric quotient <em>q</em> and the remainder <em>r</em>. Values are signed.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_kernel_calls">Kernel Calls</h3>
<div class="paragraph">
<p>Safe kernel calls may be done from Forth words using sys <em>( addr&#8201;&#8212;&#8201;)</em>. The helper variables ar, xr, yr and sr can be used to set arguments and get results through the a, x, y and status registers.</p>
</div>
<div class="paragraph">
<p>Example: <code>'0' ar c! $ffd2 sys</code> calls the CHROUT routine, which prints <code>0</code> on screen.</p>
</div>
</div>
<div class="sect2">
<h3 id="_turn_key_utilities">Turn-key Utilities</h3>
<div class="paragraph">
<p>These words are available by including <code>turnkey</code>.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">top <em>(&#8201;&#8212;&#8201;addr )</em> </dt>
<dd>
<p>Address of the top of the dictionary, default: $9fff.</p>
</dd>
<dt class="hdlist1">top! <em>( addr&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Relocate the dictionary to <em>addr</em>. Example:</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre>\ not using $a000 block, give all memory to dictionary
$cbff top!</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">save-pack <em>( "filename"&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Save a compact version of forth to the given <em>filename</em>.</p>
</dd>
<dt class="hdlist1">save-prg <em>( "filename"&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Save a forth program with no dictionary to <em>filename</em>.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Further details on the use of these words are outlined in <a href="#_turn_key_operation">Turn-key Operation</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_graphics_2">Graphics</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_turtle_graphics">Turtle Graphics</h3>
<div class="paragraph">
<p>Turtle graphics are mostly known from LOGO, a 1970s programming language.
It enables control of a turtle that can move and turn while holding a pen.
The turtle graphics library is loaded with <code>include turtle</code>.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">init <em>(&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Initialize turtle graphics.</p>
</dd>
<dt class="hdlist1">forward <em>( px&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Move the turtle <code>px</code> pixels forward.</p>
</dd>
<dt class="hdlist1">back <em>( px&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Move the turtle <code>px</code> pixels back.</p>
</dd>
<dt class="hdlist1">left <em>( deg&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Rotate the turtle <code>deg</code> degrees left.</p>
</dd>
<dt class="hdlist1">right <em>( deg&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Rotate the turtle <code>deg</code> degrees right.</p>
</dd>
<dt class="hdlist1">penup <em>(&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Pen up (disables drawing).</p>
</dd>
<dt class="hdlist1">pendown <em>(&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Pen down (enables drawing).</p>
</dd>
<dt class="hdlist1">turtle@ <em>(&#8201;&#8212;&#8201;state )</em> </dt>
<dd>
<p>Remember turtle state.</p>
</dd>
<dt class="hdlist1">turtle! <em>( state&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Restore turtle state as earlier read by <code>turtle@</code>.</p>
</dd>
<dt class="hdlist1">moveto <em>( x y deg&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Move turtle to <em>x y</em> with angle <em>deg</em>.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_high_resolution_graphics">High-Resolution Graphics</h3>
<div class="paragraph">
<p>The high-resolution graphics library is loaded with <code>include gfx</code>.
It is inspired by "Step-by-Step Programming Commodore 64: Graphics Book 3."
Some demonstrations can be found in <code>gfxdemo</code>.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">hires <em>(&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Enter the high-resolution drawing mode.</p>
</dd>
<dt class="hdlist1">lores <em>(&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Switch back to low-resolution text mode.</p>
</dd>
<dt class="hdlist1">clrcol <em>( colors&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Clear the high-resolution display using <em>colors</em>.
<em>Colors</em> is a byte value with foreground color in high nibble, background color in low nibble.
E.g. <code>15 clrcol</code> clears the screen with green background, white foreground.</p>
</dd>
<dt class="hdlist1">blkcol <em>( col row colors&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Change colors of the 8x8 block at given position.</p>
</dd>
<dt class="hdlist1">plot <em>( x y&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Set the pixel at <em>x</em>, <em>y</em>.</p>
</dd>
<dt class="hdlist1">peek <em>( x y&#8201;&#8212;&#8201;p )</em> </dt>
<dd>
<p>Get the pixel at <em>x</em>, <em>y</em>.</p>
</dd>
<dt class="hdlist1">line <em>( x y&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Draw a line to <em>x</em>, <em>y</em>.</p>
</dd>
<dt class="hdlist1">circle <em>( x y r&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Draw a circle with radius <em>r</em> around <em>x</em>, <em>y</em>.</p>
</dd>
<dt class="hdlist1">erase <em>( mode&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Change blit method for line drawing.
<code>1 erase</code> uses <code>xor</code> for line drawing, <code>0 erase</code> switches back to <code>or</code>.</p>
</dd>
<dt class="hdlist1">paint <em>( x y&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Paint the area at <em>x</em>, <em>y</em>.</p>
</dd>
<dt class="hdlist1">text <em>( column row str strlen&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Draw a text string at the given position.
E.g. <code>10 8 parse-name hallo text</code> draws the message <code>hallo</code> at column 16, row 8.</p>
</dd>
<dt class="hdlist1">drawchar <em>( column row addr&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Draw a custom character at given column and row, using the 8 bytes long data starting at addr.</p>
</dd>
</dl>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_sid">SID</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>sid</code> module contains low-level words for controlling the SID chip. To load it, type <code>include sid</code>. To test that it works, run <code>sid-demo</code>.</p>
</div>
<div class="sect2">
<h3 id="_voice_control">Voice Control</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">((voice! <em>( n&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Select SID voice 0-2.</p>
</dd>
<dt class="hdlist1">((freq! <em>( n&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Write 16-bit frequency.</p>
</dd>
<dt class="hdlist1">((pulse! <em>( n&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Write 16-bit pulse value.</p>
</dd>
<dt class="hdlist1">((control! <em>( n&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Write 8-bit control value.</p>
</dd>
<dt class="hdlist1">srad! <em>( srad&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Write 16-bit ADSR value. (Bytes are swapped.)</p>
</dd>
<dt class="hdlist1">note! <em>( n&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Play note in range [0, 94], where 0 equals C-0. The tuning is correct for PAL.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_sid_control">SID Control</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">cutoff! <em>( n&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Write 16-bit filter cutoff value.</p>
</dd>
<dt class="hdlist1">filter! <em>( n&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Write 8-bit filter value.</p>
</dd>
<dt class="hdlist1">volume! <em>( n&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Write 8-bit volume.</p>
</dd>
</dl>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_music_2">Music</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_music_macro_language">Music Macro Language</h3>
<div class="paragraph">
<p>Music Macro Language (MML) has been used since the 1970s to sequence music on computer and video game systems. The MML package is loaded with <code>include mml</code>. Two demonstration songs can be found in the <code>mmldemo</code> package.</p>
</div>
<div class="paragraph">
<p>MML songs are played using the Forth word play-mml which takes three strings, one MML melody for each of the three SID voices. An example song is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>: frere-jaques
s" o3l4fgaffgafab-&gt;c&amp;c&lt;ab-&gt;c&amp;cl8cdc&lt;b-l4af&gt;l8cdc&lt;b-l4affcf&amp;ffcf&amp;f"
s" r1o3l4fgaffgafab-&gt;c&amp;c&lt;ab-&gt;c&amp;cl8cdc&lt;b-l4af&gt;l8cdc&lt;b-l4affcf&amp;ffcf&amp;f"
s" " play-mml ;</pre>
</div>
</div>
<div class="sect3">
<h4 id="_commands">Commands</h4>
<div class="dlist">
<dl>
<dt class="hdlist1">cdefgab </dt>
<dd>
<p>The letters <code>c</code> to <code>b</code> represent musical notes.
Sharp notes are produced by appending a <code>+</code>, flat notes are produced by appending a <code>-</code>.
The length of a note is specified by appending a number representing its length as a fraction of a whole note.
For example, <code>c8</code> represents a C eight note, and <code>f+2</code> an F# half note.
Valid note lengths are 1, 2, 3, 4, 6, 8, 16, 24 and 32.
Appending a <code>.</code> increases the duration of the note by half of its value.</p>
</dd>
<dt class="hdlist1">o </dt>
<dd>
<p>Followed by a number, <code>o</code> selects the octave the instrument will play in.</p>
</dd>
<dt class="hdlist1">r </dt>
<dd>
<p>A rest. The length of the rest is specified in the same manner as the length of a note.</p>
</dd>
<dt class="hdlist1">&lt; &gt; </dt>
<dd>
<p>Used to step down or up one octave.</p>
</dd>
<dt class="hdlist1">l </dt>
<dd>
<p>Followed by a number, specifies the default length used by notes or rests which do not explicitly specify one.</p>
</dd>
<dt class="hdlist1">&amp; </dt>
<dd>
<p>Ties two notes together.</p>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_assembler_2">Assembler</h2>
<div class="sectionbody">
<div class="paragraph">
<p>DurexForth features a simple but useful 6510 assembler with support for branches and labels. Assembly code is typically used within a <code>code</code> word, as in the tutorial example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>code flash
here        ( push current addr )
$d020 inc,  ( inc $d020 )
jmp,        ( jump to pushed addr )
;code</pre>
</div>
</div>
<div class="paragraph">
<p>It is also possible to inline assembly code into a regular Forth word, as seen in the tutorial:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>: flash begin [ $d020 inc, ] again ;</pre>
</div>
</div>
<div class="sect2">
<h3 id="_variables_3">Variables</h3>
<div class="paragraph">
<p>DurexForth has a few variables that are specifically meant to be used within code words.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">lsb <em>(&#8201;&#8212;&#8201;addr )</em> </dt>
<dd>
<p><em>addr</em> points to the top of the LSB parameter stack. Together with the <code>x</code> register, it can be used to access stack contents.</p>
</dd>
<dt class="hdlist1">msb <em>(&#8201;&#8212;&#8201;addr )</em> </dt>
<dd>
<p><em>addr</em> points to the top of the MSB parameter stack. Together with the <code>x</code> register, it can be used to access stack contents.</p>
</dd>
<dt class="hdlist1">w <em>(&#8201;&#8212;&#8201;addr )</em> </dt>
<dd>
<p>A zero-page cell that code words may use freely as work area.</p>
</dd>
<dt class="hdlist1">w2 <em>(&#8201;&#8212;&#8201;addr )</em> </dt>
<dd>
<p>Second zero-page work area cell.</p>
</dd>
<dt class="hdlist1">w3 <em>(&#8201;&#8212;&#8201;addr )</em> </dt>
<dd>
<p>Third zero-page work area cell.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Example usage of <code>lsb</code> and <code>msb</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>code + ( n1 n2 -- sum )
clc,           ( clear carry )
lsb 1+ lda,x   ( load n1 lsb )
lsb adc,x      ( add n2 lsb )
lsb 1+ sta,x   ( store to n1 lsb )
msb 1+ lda,x   ( load n1 msb )
msb adc,x      ( add n2 msb )
msb 1+ sta,x   ( store to n2 msb )
inx,           ( drop n2; n1 = sum )
;code</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_branches">Branches</h3>
<div class="paragraph">
<p>The assembler supports forward and backward branches. These branches cannot overlap each other, so their usage is limited to simple cases.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">+branch <em>(&#8201;&#8212;&#8201;addr )</em> </dt>
<dd>
<p>Forward branch.</p>
</dd>
<dt class="hdlist1">:+ <em>( addr&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Forward branch target.</p>
</dd>
<dt class="hdlist1">:- <em>(&#8201;&#8212;&#8201;addr )</em> </dt>
<dd>
<p>Backward branch target.</p>
</dd>
<dt class="hdlist1">-branch <em>( addr&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Backward branch.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Example of a forward branch:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>foo lda,
+branch beq,
bar inc, :+</pre>
</div>
</div>
<div class="paragraph">
<p>Example of a backward branch:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>:- $d014 lda, f4 cmp,#
-branch bne,</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_labels">Labels</h3>
<div class="paragraph">
<p>The <code>labels</code> module adds support for more complicated flows where branches can overlap freely. These branches are resolved by the <code>;code</code> word, so it is not possible to branch past it.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">@: <em>( n&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Create the assembly label <em>n</em>, where <em>n</em> is a number in range [0, 255].</p>
</dd>
<dt class="hdlist1">@@ <em>( n&#8201;&#8212;&#8201;)</em> </dt>
<dd>
<p>Compile a branch to the label <em>n</em>.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>code checkers
$7f lda,# 0 ldy,# 'l' @:
$400 sta,y $500 sta,y
$600 sta,y $700 sta,y
dey, 'l' @@ bne, ;code</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_configuring_durexforth">Configuring durexForth</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_stripping_modules">Stripping Modules</h3>
<div class="paragraph">
<p>By default, durexForth boots up with these modules pre-compiled in RAM:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">asm</dt>
<dd>
<p>The assembler. (Required and may not be stripped.)</p>
</dd>
<dt class="hdlist1">format</dt>
<dd>
<p>Numerical formatting words. (Also required.)</p>
</dd>
<dt class="hdlist1">wordlist</dt>
<dd>
<p>Wordlist manipulation. (Required by some modules.)</p>
</dd>
<dt class="hdlist1">labels</dt>
<dd>
<p>Assembler labels.</p>
</dd>
<dt class="hdlist1">doloop</dt>
<dd>
<p>Do-loop words.</p>
</dd>
<dt class="hdlist1">sys</dt>
<dd>
<p>System calls.</p>
</dd>
<dt class="hdlist1">debug</dt>
<dd>
<p>Words for debugging.</p>
</dd>
<dt class="hdlist1">ls</dt>
<dd>
<p>List disk contents.</p>
</dd>
<dt class="hdlist1">require</dt>
<dd>
<p>The words require and required.</p>
</dd>
<dt class="hdlist1">v</dt>
<dd>
<p>The text editor.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>To reduce RAM usage, you may make a stripped-down version of durexForth. Do this by following these steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Issue ---modules--- to unload all modules, or ---editor--- to unload the editor only.</p>
</li>
<li>
<p>One by one, load the modules you want included with your new Forth. (E.g. include labels)</p>
</li>
<li>
<p>Save the new system with e.g. save-forth acmeforth.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_custom_start_up">Custom Start-Up</h3>
<div class="paragraph">
<p>You may launch a word automatically at start-up by setting the variable start to the execution token of the word.  Example: ' megademo start ! To save the new configuration to disk, type e.g. save-forth megademo.</p>
</div>
<div class="paragraph">
<p>When writing a new program using a PC text editor, it is practical to configure durexForth to compile and execute the program at startup. That can be set up using the following snippet:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$a000 value buf
: go buf s" myprogramfile" buf
loadb buf - evaluate ;
' go start !
save-forth @0:durexforth</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_turn_key_operation">Turn-key Operation</h3>
<div class="paragraph">
<p>Durexforth offers utilities to save your program in a turn-key fashion by including the turnkey module once the program is ready to be saved.</p>
</div>
<div class="paragraph">
<p>Programs can be saved in a compacted state using save-pack. These programs are stored with 32 bytes between here and latest. When they are first loaded, they will restore the header space to its original top.</p>
</div>
<div class="paragraph">
<p>If you have developed a program that has no further need of the interpreter, you can eliminate the dictionary headers entirely when saving with save-prg. This allows your program to use memory down to here plus 32 bytes for safety.</p>
</div>
<div class="paragraph">
<p>After either of these words have saved the file to disk, they will restore forth to the unpacked state, and strip the turnkey module from the dictionary. This allows you to continue to use forth interactively in the case of save-pack. As save-prg has stripped the dictionary headers from the system, it will no longer be usable. If you wish to test your program after saving, you can compile a call to save-prg instead:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>: build save-prg mydemo start @ execute ;
build</pre>
</div>
</div>
<div class="paragraph">
<p>This will simulate the start-up sequence after saving the packed program.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_assembler_mnemonics">Appendix A: Assembler Mnemonics</h2>
<div class="sectionbody">
<div class="verseblock">
<pre class="content">adc,# adc, adc,x adc,y adc,(x) adc,(y)
and,# and, and,x and,y and,(x) and,(y)
asl,a asl, asl,x
bcc,
bcs,
beq,
bmi,
bne,
bpl,
bvc,
bvs,
bit,
brk,
clc,
cld,
cli,
clv,
cmp,# cmp, cmp,x cmp,y cmp,(x) cmp,(y)
cpx,# cpx,
cpy,# cpy,
dec, dec,x
dex,
dey,
eor,# eor, eor,x eor,y eor,(x) eor,(y)
inc, inc,x
inx,
iny,
jmp, (jmp),
jsr,
lda,# lda, lda,x lda,y lda,(x) lda,(y)
ldx,# ldx, ldx,y
ldy ldy,# ldy, ldy,x
lsr,a lsr, lsr,x
nop,
ora,# ora, ora,x ora,y ora,(x) ora,(y)
pha,
php,
pla,
plp,
rol,a rol, rol,x
ror,a ror, ror,x
rti,
rts,
sbc,# sbc, sbc,x sbc,y sbc,(x) sbc,(y)
sec,
sed,
sei,
sta, sta,x sta,y sta,(x) sta,(y)
stx, stx,y
sty, sty,x
tax,
tay,
tsx,
txa,
txs,
tya,</pre>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_memory_map">Appendix B: Memory Map</h2>
<div class="sectionbody">
<div class="dlist">
<dl>
<dt class="hdlist1">3 - $3a </dt>
<dd>
<p>Parameter stack, <code>lsb</code> section.</p>
</dd>
<dt class="hdlist1">$3b - $72 </dt>
<dd>
<p>Parameter stack, <code>msb</code> section.</p>
</dd>
<dt class="hdlist1">$8b - $8c </dt>
<dd>
<p><code>w</code> (work area for code words).</p>
</dd>
<dt class="hdlist1">$8d - $8e </dt>
<dd>
<p><code>w2</code> (work area for code words).</p>
</dd>
<dt class="hdlist1">$9e - $9f </dt>
<dd>
<p><code>w3</code> (work area for code words).</p>
</dd>
<dt class="hdlist1">$100 - $1ff </dt>
<dd>
<p>Return stack.</p>
</dd>
<dt class="hdlist1">$200 - $258 </dt>
<dd>
<p>Text input buffer.</p>
</dd>
<dt class="hdlist1">$33C - $35A </dt>
<dd>
<p><code>find</code> buffer.</p>
</dd>
<dt class="hdlist1">$35B - $3FB </dt>
<dd>
<p><code>pad</code> Scratch pad memory, Cassette Buffer, untouched by DurexForth.</p>
</dd>
<dt class="hdlist1">$801 - here </dt>
<dd>
<p>Forth Kernel followed by code and data space.</p>
</dd>
<dt class="hdlist1">latest - $9fff </dt>
<dd>
<p>Dictionary. Grows downwards as needed.</p>
</dd>
<dt class="hdlist1">$a000 - $cbff </dt>
<dd>
<p>Editor text buffer.</p>
</dd>
<dt class="hdlist1">$cc00 - $cfff </dt>
<dd>
<p>Hi-res graphics colors.</p>
</dd>
<dt class="hdlist1">$d000 - $dfff </dt>
<dd>
<p>I/O area.</p>
</dd>
<dt class="hdlist1">$e000 - $ffff </dt>
<dd>
<p>Kernal / hi-res graphics bitmap.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_word_anatomy">Appendix C: Word Anatomy</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Let us define a word and see what it gets compiled to.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>: bg $d020 c! ;</pre>
</div>
</div>
<div class="paragraph">
<p>Information about the word is split into two areas of memory, the dictionary and the code/data space. Code and data are placed in an upward-growing segment starting at $801, and the dictionary grows downward from <code>top</code>. <code>latest</code> points to the last dictionary record. A dictionary record consists of a counted string with flags, and an execution token (<em>xt</em>).</p>
</div>
<div class="paragraph">
<p>To inspect the dictionary entry, type <code>latest dump</code>. You should see something like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>6228  02 42 47 fd 39 28 39 01 .bg.9(9.
...</pre>
</div>
</div>
<div class="paragraph">
<p>For this run, the name token of <code>bg</code> is placed at address $6228. The first byte, <code>02</code>, is the name length (<code>bg</code> has two characters). After that, the string <code>bg</code> follows. ($42 = <code>b</code>, $47 = <code>g</code>). The final two bytes contain the execution token of <code>bg</code>, starting at $39fd.</p>
</div>
<div class="paragraph">
<p>The name length byte is also used to store special attributes of the word. Bit 7 is "immediate" flag, which means that the word should execute immediately instead of being compiled into word definitions. (<code>(</code> is such an example of an immediate word that does not get compiled.) Bit 6 is the "no-tail-call-elimination" flag, which makes sure that tail call elimination (the practice of replacing jsr/rts with jmp) is not performed if this word is the jsr target. Since <code>bg</code> does not have these flags set, bits 7 and 6 are both clear.</p>
</div>
<div class="paragraph">
<p>We saw that the <code>bg</code> execution token is $39fd. To inspect the code, type <code>$39fd dump</code> or <code>latest &gt;xt dump</code>.</p>
</div>
<div class="paragraph">
<p>The code section contains pure 6502 machine code.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>39fd  20 15 11 20 d0 4c 0e 09  .. Pl..
...</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">20 15 11 </dt>
<dd>
<p><code>jsr $1115</code>. $1115 is the address of the <code>lit</code> code. <code>lit</code> copies the two following bytes to parameter stack.</p>
</dd>
<dt class="hdlist1">20 d0 </dt>
<dd>
<p><code>$d020</code>. The parameter to the <code>lit</code> word. When executed, <code>lit</code> will add $d020 to the parameter stack.</p>
</dd>
<dt class="hdlist1">4c 0e 09 </dt>
<dd>
<p><code>jmp $90e</code>. $90e is the address of the <code>c!</code> code.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_avoiding_stack_crashes">Appendix D: Avoiding Stack Crashes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Stack overflow and underflow are common causes for errors and crashes.
Simply put, the data stack must not contain too many or too few items.
This section describes some techniques to avoid such errors.</p>
</div>
<div class="paragraph">
<p>One helpful technique to avoid stack crashes is to add comments about stack usage.
In this example, we imagine a graphics word "drawbox" that draws a black box.
( color -- ) indicates that it takes one argument on stack, and on exit it should
leave nothing on the stack.
The comments inside the word (starting with £) indicate what the stack
looks like after the line has executed.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>: drawbox ( color -- )
10 begin dup 20 &lt; while £ color x
10 begin dup 20 &lt; while £ color x y
2dup £ color x y x y
4 pick £ color x y x y color
blkcol £ color x y
1+ repeat drop £ color x
1+ repeat 2drop ;</pre>
</div>
</div>
<div class="paragraph">
<p>Once the word is working as supposed, it may be nice to again remove the comments, as
they are no longer very interesting to read.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The Forth standard defines backslash (\) as the line comment character, but the C64 lacks a real backslash.
Moreover, ASCII \ and PETSCII £ both map to $5c.
Therefore, the £ character is used as a substitution on the C64.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Another useful technique during development is to check at the end of your main loop
that the stack depth is what you expect it to. This will catch stack underflows
and overflows.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>: mainloop begin
( do stuff here... )
depth abort" depth not 0"
again ;</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_internet_resources">Appendix E: Internet Resources</h2>
<div class="sectionbody">
<div class="dlist">
<dl>
<dt class="hdlist1">Forth Books and Papers</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.forth.com/starting-forth/">Starting Forth</a></p>
</li>
<li>
<p><a href="http://thinking-forth.sourceforge.net/">Thinking Forth</a></p>
</li>
<li>
<p><a href="https://www.bradrodriguez.com/papers/">Moving Forth: a series on writing Forth kernels</a></p>
</li>
<li>
<p><a href="http://forth.org/">Forth Interest Group</a></p>
</li>
<li>
<p><a href="https://archive.org/details/transactor-magazines-v7-i05/page/n59/mode/2up">Blazin' Forth --- An inside look at the Blazin' Forth compiler</a></p>
</li>
<li>
<p><a href="https://www.drdobbs.com/architecture-and-design/the-evolution-of-forth-an-unusual-langua/228700557">The Evolution of FORTH, an unusual language</a></p>
</li>
<li>
<p><a href="https://galileo.phys.virginia.edu/classes/551.jvn.fall01/primer.htm">A Beginner&#8217;s Guide to Forth</a></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Other Forths</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><a href="https://colorforth.github.io/">colorForth</a></p>
</li>
<li>
<p><a href="https://gforth.org/">Gforth</a></p>
</li>
<li>
<p><a href="https://github.com/nornagon/jonesforth">jonesforth</a></p>
</li>
<li>
<p><a href="https://github.com/chitselb/pettil">PETTIL</a></p>
</li>
<li>
<p><a href="https://github.com/forth-ev/VolksForth">volksFORTH</a></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Forth Standards</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><a href="https://forth-standard.org/">Forth 2012 Standard</a></p>
</li>
<li>
<p><a href="https://www.taygeta.com/forth/dpans.html">ANS Forth</a></p>
</li>
<li>
<p><a href="http://forth.sourceforge.net/standard/fst83/">FORTH-83 STANDARD</a></p>
</li>
<li>
<p><a href="https://atariwiki.org/wiki/attach/Forth79/Forth-79-OCR.pdf">FORTH-79 STANDARD</a></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">C64 References</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><a href="https://sourceforge.net/projects/acme-crossass/">ACME Cross-Assembler</a></p>
</li>
<li>
<p><a href="https://codebase64.org/">Codebase 64</a></p>
</li>
<li>
<p><a href="http://unusedino.de/ec64/technical/aay/c64/">All About Your C64</a></p>
</li>
<li>
<p><a href="https://project64.c64.org/Software/mapc6411.txt">Mapping the Commodore 64</a></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_license">Appendix F: License</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre>Copyright (c) 2008 Johan Kotlinski, Mats Andrén
Copyright (c) 2012 Kevin Lee Reno
Copyright (c) 2017 Corey Minter
Copyright (c) 2020 Poindexter Frink, Richard Halkyard

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>/ MOD */MOD */ ?NEGATE ?DNEGATE DABS SM/REM
Forth Interest Group UK. Public domain.</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>UM/MOD
Copyright (c) 2002 Garth Wilson. Public domain.</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>petcom.c
Copyright (c) 1995 Craig Bruce. Public domain.</pre>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version v4.0.0-64-gfa3e4a5<br>
Last updated 2022-08-21 22:10:07 +0200
</div>
</div>
</body>
</html>