<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
    "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8" />
<meta name="generator" content="AsciiDoc 9.1.1" />
<title>durexForth: Operators Manual</title>
<style type="text/css">
/* Shared CSS for AsciiDoc xhtml11 and html5 backends */

/* Default font. */
body {
  font-family: Georgia,serif;
}

/* Title font. */
h1, h2, h3, h4, h5, h6,
div.title, caption.title,
thead, p.table.header,
#toctitle,
#author, #revnumber, #revdate, #revremark,
#footer {
  font-family: Arial,Helvetica,sans-serif;
}

body {
  margin: 1em 5% 1em 5%;
}

a {
  color: blue;
  text-decoration: underline;
}
a:visited {
  color: fuchsia;
}

em {
  font-style: italic;
  color: navy;
}

strong {
  font-weight: bold;
  color: #083194;
}

h1, h2, h3, h4, h5, h6 {
  color: #527bbd;
  margin-top: 1.2em;
  margin-bottom: 0.5em;
  line-height: 1.3;
}

h1, h2, h3 {
  border-bottom: 2px solid silver;
}
h2 {
  padding-top: 0.5em;
}
h3 {
  float: left;
}
h3 + * {
  clear: left;
}
h5 {
  font-size: 1.0em;
}

div.sectionbody {
  margin-left: 0;
}

hr {
  border: 1px solid silver;
}

p {
  margin-top: 0.5em;
  margin-bottom: 0.5em;
}

ul, ol, li > p {
  margin-top: 0;
}
ul > li     { color: #aaa; }
ul > li > * { color: black; }

.monospaced, code, pre {
  font-family: "Courier New", Courier, monospace;
  font-size: inherit;
  color: navy;
  padding: 0;
  margin: 0;
}
pre {
  white-space: pre-wrap;
}

#author {
  color: #527bbd;
  font-weight: bold;
  font-size: 1.1em;
}
#email {
}
#revnumber, #revdate, #revremark {
}

#footer {
  font-size: small;
  border-top: 2px solid silver;
  padding-top: 0.5em;
  margin-top: 4.0em;
}
#footer-text {
  float: left;
  padding-bottom: 0.5em;
}
#footer-badges {
  float: right;
  padding-bottom: 0.5em;
}

#preamble {
  margin-top: 1.5em;
  margin-bottom: 1.5em;
}
div.imageblock, div.exampleblock, div.verseblock,
div.quoteblock, div.literalblock, div.listingblock, div.sidebarblock,
div.admonitionblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
div.admonitionblock {
  margin-top: 2.0em;
  margin-bottom: 2.0em;
  margin-right: 10%;
  color: #606060;
}

div.content { /* Block element content. */
  padding: 0;
}

/* Block element titles. */
div.title, caption.title {
  color: #527bbd;
  font-weight: bold;
  text-align: left;
  margin-top: 1.0em;
  margin-bottom: 0.5em;
}
div.title + * {
  margin-top: 0;
}

td div.title:first-child {
  margin-top: 0.0em;
}
div.content div.title:first-child {
  margin-top: 0.0em;
}
div.content + div.title {
  margin-top: 0.0em;
}

div.sidebarblock > div.content {
  background: #ffffee;
  border: 1px solid #dddddd;
  border-left: 4px solid #f0f0f0;
  padding: 0.5em;
}

div.listingblock > div.content {
  border: 1px solid #dddddd;
  border-left: 5px solid #f0f0f0;
  background: #f8f8f8;
  padding: 0.5em;
}

div.quoteblock, div.verseblock {
  padding-left: 1.0em;
  margin-left: 1.0em;
  margin-right: 10%;
  border-left: 5px solid #f0f0f0;
  color: #888;
}

div.quoteblock > div.attribution {
  padding-top: 0.5em;
  text-align: right;
}

div.verseblock > pre.content {
  font-family: inherit;
  font-size: inherit;
}
div.verseblock > div.attribution {
  padding-top: 0.75em;
  text-align: left;
}
/* DEPRECATED: Pre version 8.2.7 verse style literal block. */
div.verseblock + div.attribution {
  text-align: left;
}

div.admonitionblock .icon {
  vertical-align: top;
  font-size: 1.1em;
  font-weight: bold;
  text-decoration: underline;
  color: #527bbd;
  padding-right: 0.5em;
}
div.admonitionblock td.content {
  padding-left: 0.5em;
  border-left: 3px solid #dddddd;
}

div.exampleblock > div.content {
  border-left: 3px solid #dddddd;
  padding-left: 0.5em;
}

div.imageblock div.content { padding-left: 0; }
span.image img { border-style: none; vertical-align: text-bottom; }
a.image:visited { color: white; }

dl {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
dt {
  margin-top: 0.5em;
  margin-bottom: 0;
  font-style: normal;
  color: navy;
}
dd > *:first-child {
  margin-top: 0.1em;
}

ul, ol {
    list-style-position: outside;
}
ol.arabic {
  list-style-type: decimal;
}
ol.loweralpha {
  list-style-type: lower-alpha;
}
ol.upperalpha {
  list-style-type: upper-alpha;
}
ol.lowerroman {
  list-style-type: lower-roman;
}
ol.upperroman {
  list-style-type: upper-roman;
}

div.compact ul, div.compact ol,
div.compact p, div.compact p,
div.compact div, div.compact div {
  margin-top: 0.1em;
  margin-bottom: 0.1em;
}

tfoot {
  font-weight: bold;
}
td > div.verse {
  white-space: pre;
}

div.hdlist {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
div.hdlist tr {
  padding-bottom: 15px;
}
dt.hdlist1.strong, td.hdlist1.strong {
  font-weight: bold;
}
td.hdlist1 {
  vertical-align: top;
  font-style: normal;
  padding-right: 0.8em;
  color: navy;
}
td.hdlist2 {
  vertical-align: top;
}
div.hdlist.compact tr {
  margin: 0;
  padding-bottom: 0;
}

.comment {
  background: yellow;
}

.footnote, .footnoteref {
  font-size: 0.8em;
}

span.footnote, span.footnoteref {
  vertical-align: super;
}

#footnotes {
  margin: 20px 0 20px 0;
  padding: 7px 0 0 0;
}

#footnotes div.footnote {
  margin: 0 0 5px 0;
}

#footnotes hr {
  border: none;
  border-top: 1px solid silver;
  height: 1px;
  text-align: left;
  margin-left: 0;
  width: 20%;
  min-width: 100px;
}

div.colist td {
  padding-right: 0.5em;
  padding-bottom: 0.3em;
  vertical-align: top;
}
div.colist td img {
  margin-top: 0.3em;
}

@media print {
  #footer-badges { display: none; }
}

#toc {
  margin-bottom: 2.5em;
}

#toctitle {
  color: #527bbd;
  font-size: 1.1em;
  font-weight: bold;
  margin-top: 1.0em;
  margin-bottom: 0.1em;
}

div.toclevel0, div.toclevel1, div.toclevel2, div.toclevel3, div.toclevel4 {
  margin-top: 0;
  margin-bottom: 0;
}
div.toclevel2 {
  margin-left: 2em;
  font-size: 0.9em;
}
div.toclevel3 {
  margin-left: 4em;
  font-size: 0.9em;
}
div.toclevel4 {
  margin-left: 6em;
  font-size: 0.9em;
}

span.aqua { color: aqua; }
span.black { color: black; }
span.blue { color: blue; }
span.fuchsia { color: fuchsia; }
span.gray { color: gray; }
span.green { color: green; }
span.lime { color: lime; }
span.maroon { color: maroon; }
span.navy { color: navy; }
span.olive { color: olive; }
span.purple { color: purple; }
span.red { color: red; }
span.silver { color: silver; }
span.teal { color: teal; }
span.white { color: white; }
span.yellow { color: yellow; }

span.aqua-background { background: aqua; }
span.black-background { background: black; }
span.blue-background { background: blue; }
span.fuchsia-background { background: fuchsia; }
span.gray-background { background: gray; }
span.green-background { background: green; }
span.lime-background { background: lime; }
span.maroon-background { background: maroon; }
span.navy-background { background: navy; }
span.olive-background { background: olive; }
span.purple-background { background: purple; }
span.red-background { background: red; }
span.silver-background { background: silver; }
span.teal-background { background: teal; }
span.white-background { background: white; }
span.yellow-background { background: yellow; }

span.big { font-size: 2em; }
span.small { font-size: 0.6em; }

span.underline { text-decoration: underline; }
span.overline { text-decoration: overline; }
span.line-through { text-decoration: line-through; }

div.unbreakable { page-break-inside: avoid; }


/*
 * xhtml11 specific
 *
 * */

div.tableblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
div.tableblock > table {
  border: 3px solid #527bbd;
}
thead, p.table.header {
  font-weight: bold;
  color: #527bbd;
}
p.table {
  margin-top: 0;
}
/* Because the table frame attribute is overridden by CSS in most browsers. */
div.tableblock > table[frame="void"] {
  border-style: none;
}
div.tableblock > table[frame="hsides"] {
  border-left-style: none;
  border-right-style: none;
}
div.tableblock > table[frame="vsides"] {
  border-top-style: none;
  border-bottom-style: none;
}


/*
 * html5 specific
 *
 * */

table.tableblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
thead, p.tableblock.header {
  font-weight: bold;
  color: #527bbd;
}
p.tableblock {
  margin-top: 0;
}
table.tableblock {
  border-width: 3px;
  border-spacing: 0px;
  border-style: solid;
  border-color: #527bbd;
  border-collapse: collapse;
}
th.tableblock, td.tableblock {
  border-width: 1px;
  padding: 4px;
  border-style: solid;
  border-color: #527bbd;
}

table.tableblock.frame-topbot {
  border-left-style: hidden;
  border-right-style: hidden;
}
table.tableblock.frame-sides {
  border-top-style: hidden;
  border-bottom-style: hidden;
}
table.tableblock.frame-none {
  border-style: hidden;
}

th.tableblock.halign-left, td.tableblock.halign-left {
  text-align: left;
}
th.tableblock.halign-center, td.tableblock.halign-center {
  text-align: center;
}
th.tableblock.halign-right, td.tableblock.halign-right {
  text-align: right;
}

th.tableblock.valign-top, td.tableblock.valign-top {
  vertical-align: top;
}
th.tableblock.valign-middle, td.tableblock.valign-middle {
  vertical-align: middle;
}
th.tableblock.valign-bottom, td.tableblock.valign-bottom {
  vertical-align: bottom;
}


/*
 * manpage specific
 *
 * */

body.manpage h1 {
  padding-top: 0.5em;
  padding-bottom: 0.5em;
  border-top: 2px solid silver;
  border-bottom: 2px solid silver;
}
body.manpage h2 {
  border-style: none;
}
body.manpage div.sectionbody {
  margin-left: 3em;
}

@media print {
  body.manpage div#toc { display: none; }
}


</style>
<script type="text/javascript">
/*<![CDATA[*/
var asciidoc = {  // Namespace.

/////////////////////////////////////////////////////////////////////
// Table Of Contents generator
/////////////////////////////////////////////////////////////////////

/* Author: Mihai Bazon, September 2002
 * http://students.infoiasi.ro/~mishoo
 *
 * Table Of Content generator
 * Version: 0.4
 *
 * Feel free to use this script under the terms of the GNU General Public
 * License, as long as you do not remove or alter this notice.
 */

 /* modified by Troy D. Hanson, September 2006. License: GPL */
 /* modified by Stuart Rackham, 2006, 2009. License: GPL */

// toclevels = 1..4.
toc: function (toclevels) {

  function getText(el) {
    var text = "";
    for (var i = el.firstChild; i != null; i = i.nextSibling) {
      if (i.nodeType == 3 /* Node.TEXT_NODE */) // IE doesn't speak constants.
        text += i.data;
      else if (i.firstChild != null)
        text += getText(i);
    }
    return text;
  }

  function TocEntry(el, text, toclevel) {
    this.element = el;
    this.text = text;
    this.toclevel = toclevel;
  }

  function tocEntries(el, toclevels) {
    var result = new Array;
    var re = new RegExp('[hH]([1-'+(toclevels+1)+'])');
    // Function that scans the DOM tree for header elements (the DOM2
    // nodeIterator API would be a better technique but not supported by all
    // browsers).
    var iterate = function (el) {
      for (var i = el.firstChild; i != null; i = i.nextSibling) {
        if (i.nodeType == 1 /* Node.ELEMENT_NODE */) {
          var mo = re.exec(i.tagName);
          if (mo && (i.getAttribute("class") || i.getAttribute("className")) != "float") {
            result[result.length] = new TocEntry(i, getText(i), mo[1]-1);
          }
          iterate(i);
        }
      }
    }
    iterate(el);
    return result;
  }

  var toc = document.getElementById("toc");
  if (!toc) {
    return;
  }

  // Delete existing TOC entries in case we're reloading the TOC.
  var tocEntriesToRemove = [];
  var i;
  for (i = 0; i < toc.childNodes.length; i++) {
    var entry = toc.childNodes[i];
    if (entry.nodeName.toLowerCase() == 'div'
     && entry.getAttribute("class")
     && entry.getAttribute("class").match(/^toclevel/))
      tocEntriesToRemove.push(entry);
  }
  for (i = 0; i < tocEntriesToRemove.length; i++) {
    toc.removeChild(tocEntriesToRemove[i]);
  }

  // Rebuild TOC entries.
  var entries = tocEntries(document.getElementById("content"), toclevels);
  for (var i = 0; i < entries.length; ++i) {
    var entry = entries[i];
    if (entry.element.id == "")
      entry.element.id = "_toc_" + i;
    var a = document.createElement("a");
    a.href = "#" + entry.element.id;
    a.appendChild(document.createTextNode(entry.text));
    var div = document.createElement("div");
    div.appendChild(a);
    div.className = "toclevel" + entry.toclevel;
    toc.appendChild(div);
  }
  if (entries.length == 0)
    toc.parentNode.removeChild(toc);
},


/////////////////////////////////////////////////////////////////////
// Footnotes generator
/////////////////////////////////////////////////////////////////////

/* Based on footnote generation code from:
 * http://www.brandspankingnew.net/archive/2005/07/format_footnote.html
 */

footnotes: function () {
  // Delete existing footnote entries in case we're reloading the footnodes.
  var i;
  var noteholder = document.getElementById("footnotes");
  if (!noteholder) {
    return;
  }
  var entriesToRemove = [];
  for (i = 0; i < noteholder.childNodes.length; i++) {
    var entry = noteholder.childNodes[i];
    if (entry.nodeName.toLowerCase() == 'div' && entry.getAttribute("class") == "footnote")
      entriesToRemove.push(entry);
  }
  for (i = 0; i < entriesToRemove.length; i++) {
    noteholder.removeChild(entriesToRemove[i]);
  }

  // Rebuild footnote entries.
  var cont = document.getElementById("content");
  var spans = cont.getElementsByTagName("span");
  var refs = {};
  var n = 0;
  for (i=0; i<spans.length; i++) {
    if (spans[i].className == "footnote") {
      n++;
      var note = spans[i].getAttribute("data-note");
      if (!note) {
        // Use [\s\S] in place of . so multi-line matches work.
        // Because JavaScript has no s (dotall) regex flag.
        note = spans[i].innerHTML.match(/\s*\[([\s\S]*)]\s*/)[1];
        spans[i].innerHTML =
          "[<a id='_footnoteref_" + n + "' href='#_footnote_" + n +
          "' title='View footnote' class='footnote'>" + n + "</a>]";
        spans[i].setAttribute("data-note", note);
      }
      noteholder.innerHTML +=
        "<div class='footnote' id='_footnote_" + n + "'>" +
        "<a href='#_footnoteref_" + n + "' title='Return to text'>" +
        n + "</a>. " + note + "</div>";
      var id =spans[i].getAttribute("id");
      if (id != null) refs["#"+id] = n;
    }
  }
  if (n == 0)
    noteholder.parentNode.removeChild(noteholder);
  else {
    // Process footnoterefs.
    for (i=0; i<spans.length; i++) {
      if (spans[i].className == "footnoteref") {
        var href = spans[i].getElementsByTagName("a")[0].getAttribute("href");
        href = href.match(/#.*/)[0];  // Because IE return full URL.
        n = refs[href];
        spans[i].innerHTML =
          "[<a href='#_footnote_" + n +
          "' title='View footnote' class='footnote'>" + n + "</a>]";
      }
    }
  }
},

install: function(toclevels) {
  var timerId;

  function reinstall() {
    asciidoc.footnotes();
    if (toclevels) {
      asciidoc.toc(toclevels);
    }
  }

  function reinstallAndRemoveTimer() {
    clearInterval(timerId);
    reinstall();
  }

  timerId = setInterval(reinstall, 500);
  if (document.addEventListener)
    document.addEventListener("DOMContentLoaded", reinstallAndRemoveTimer, false);
  else
    window.onload = reinstallAndRemoveTimer;
}

}
asciidoc.install(2);
/*]]>*/
</script>
</head>
<body class="article">
<div id="header">
<h1>durexForth: Operators Manual</h1>
<div id="toc">
  <div id="toctitle">Table of Contents</div>
  <noscript><p><b>JavaScript must be enabled in your browser to display the table of contents.</b></p></noscript>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_introduction">Introduction</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_forth_the_language">Forth, the Language</h3>
<div class="sect3">
<h4 id="_why_forth">Why Forth?</h4>
<div class="paragraph"><p>Forth is a unique language. What is so special about it? It is a small, low-level language, which can easily be extended to a high-level, domain-specific language that does anything you want it to. Compared to C64 Basic, Forth is more attractive in almost every way. It is a lot faster, more memory effective, and more powerful.</p></div>
<div class="paragraph"><p>Compared to C, the nice thing about Forth is that you can run the full development environment on your C64,
with text editor, compiler, assembler and debugger. It makes for a more interactive and fun experience than running a cross-compiler on PC.</p></div>
<div class="paragraph"><p>For a Forth introduction, please refer to the excellent
<a href="http://www.forth.com/starting-forth/">Starting Forth</a> by Leo Brodie. As a follow-up, I
recommend <a href="http://thinking-forth.sourceforge.net/">Thinking Forth</a> by the same author.</p></div>
</div>
<div class="sect3">
<h4 id="_comparing_to_other_forths">Comparing to other Forths</h4>
<div class="paragraph"><p>There are other Forths for C64, most notably Blazin' Forth. Blazin' Forth is excellent, but durexForth has some advantages:</p></div>
<div class="ulist"><ul>
<li>
<p>
durexForth uses text files instead of a custom block file system.
</p>
</li>
<li>
<p>
durexForth is smaller.
</p>
</li>
<li>
<p>
durexForth is faster.
</p>
</li>
<li>
<p>
durexForth can boot from cartridge.
</p>
</li>
<li>
<p>
durexForth implements the Forth 2012 core standard.
</p>
</li>
<li>
<p>
The durexForth editor is a vi clone.
</p>
</li>
<li>
<p>
durexForth is open source (available at <a href="https://github.com/jkotlinski/durexforth">Github</a>).
</p>
</li>
</ul></div>
</div>
</div>
<div class="sect2">
<h3 id="_package_contents">Package Contents</h3>
<div class="paragraph"><p>durexForth is packaged as a 16-kByte .crt cartridge file and a .d64 disk image. Booting from cartridge is equivalent to booting from disk, except that cartridge is faster. The disk contains various optional Forth modules, as well as some appetizer demonstration programs, as follows:</p></div>
<div class="sect3">
<h4 id="_graphics">Graphics</h4>
<div class="paragraph"><p>The gfxdemo package demonstrates the high-resolution graphics, with some examples adapted from the book "Step-By-Step Programming C64 Graphics" by Phil Cornes.
Show the demos by entering:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>include gfxdemo</code></pre>
</div></div>
<div class="paragraph"><p>When an image has finished drawing, press space to continue.</p></div>
</div>
<div class="sect3">
<h4 id="_fractals">Fractals</h4>
<div class="paragraph"><p>The fractals package demonstrates turtle graphics by generating fractal images. Run it by entering:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>include fractals</code></pre>
</div></div>
<div class="paragraph"><p>When an image has finished drawing, press space to continue.</p></div>
</div>
<div class="sect3">
<h4 id="_music">Music</h4>
<div class="paragraph"><p>The mmldemo package demonstrates the MML music capabilities. To play some music:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>include mmldemo</code></pre>
</div></div>
</div>
<div class="sect3">
<h4 id="_sprites">Sprites</h4>
<div class="paragraph"><p>The sprite package adds functionality for defining and displaying sprites. To run the demo:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>include spritedemo</code></pre>
</div></div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_tutorial">Tutorial</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_interpreter">Interpreter</h3>
<div class="paragraph"><p>Start up durexForth. When loaded, it will greet you with a blinking yellow cursor, waiting for your input. You have landed in the interpreter!</p></div>
<div class="paragraph"><p>Let&#8217;s warm it up a little. Enter <code>1</code> (followed by return). You have now put a digit on the stack. This can be verified by the command <code>.s</code>, which will print the stack contents without modifying it. Now enter <code>.</code> to pop the digit and print it to screen, followed by <code>.s</code> to verify that the stack is empty.</p></div>
<div class="paragraph"><p>Let&#8217;s define a word <code>bg!</code> for setting the border color&#8230;</p></div>
<div class="listingblock">
<div class="content">
<pre><code>: bg! $d020 c! ;</code></pre>
</div></div>
<div class="paragraph"><p>Now try entering <code>1 bg!</code> to change the border color to white.
Then, try changing it back again with <code>0 bg!</code>.</p></div>
</div>
<div class="sect2">
<h3 id="_introducing_the_editor">Introducing the Editor</h3>
<div class="paragraph"><p>The v editor is convenient for editing larger pieces of code. With it, you keep an entire source file loaded in RAM, and you can recompile and test it easily.</p></div>
<div class="paragraph"><p>Start the editor by typing <code>v</code>. You will enter the red editor screen. To enter text, first press <code>i</code> to enter insert mode. This mode allows you to insert text into the buffer. You can see that it&#8217;s active on the <code>I</code> that appears in the lower left corner. This is a good start for creating a program!</p></div>
<div class="paragraph"><p>Now, enter the following lines&#8230;</p></div>
<div class="listingblock">
<div class="content">
<pre><code>: flash begin 1 $d020 +! again ; flash</code></pre>
</div></div>
<div class="paragraph"><p>&#8230;and then press &larr; to leave insert mode.
Press <em>F7</em> to compile and run. If everything is entered right, you will be facing a beautiful color cycle.</p></div>
<div class="paragraph"><p>When you finished watching, press <em>RESTORE</em> to quit your program, then enter <code>v</code> to reopen the editor.</p></div>
</div>
<div class="sect2">
<h3 id="_assembler">Assembler</h3>
<div class="paragraph"><p>If you want to color cycle as fast as possible, it is possible to use the durexForth assembler to generate machine code. <code>code</code> and <code>;code</code> define a code word, just like <code>:</code> and <code>;</code> define Forth words. Within a code word, you can use assembler mnemonics.</p></div>
<div class="listingblock">
<div class="content">
<pre><code>code flash
here ( push current addr )
$d020 inc,
jmp, ( jump to pushed addr )
;code
flash</code></pre>
</div></div>
<div class="paragraph"><p>It is also possible to use inline assembly within regular Forth words:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>: flash begin [ $d020 inc, ] again ;
flash</code></pre>
</div></div>
<div class="paragraph"><p>Note: As the <code>x</code> register contains the parameter stack depth, it is important that your assembly code leaves it unchanged.</p></div>
</div>
<div class="sect2">
<h3 id="_console_i_o_example">Console I/O Example</h3>
<div class="paragraph"><p>This piece of code reads from keyboard and sends back the chars to screen:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>: foo key emit recurse ;
foo</code></pre>
</div></div>
</div>
<div class="sect2">
<h3 id="_printer_example">Printer Example</h3>
<div class="paragraph"><p>This piece of code prints a message to a printer on device #4, and then prints a message to the screen:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>include io

: print-hello
4 device ( use device 4 )
0 0 47 7 open ioabort ( open address 7 as file 47, abort on failure )
47 chkout ioabort ( redirect output to file 47, abort on failure )
." Hello, printer!" cr
clrchn ( stop input and output redirection )
." Hello, screen!" cr
47 close ( close file 47 ) ;

print-hello</code></pre>
</div></div>
<div class="paragraph"><p>The device number and address may differ between printer models. Commodore MPS series printers use address 0 to print in their uppercase/graphics font, and address 7 to print in their lowercase/uppercase font.</p></div>
</div>
<div class="sect2">
<h3 id="_avoiding_stack_crashes">Avoiding Stack Crashes</h3>
<div class="paragraph"><p>Stack overflow and underflow are common causes for errors and crashes.
Simply put, the data stack must not contain too many or too few items.
This section describes some techniques to avoid such errors.</p></div>
<div class="sect3">
<h4 id="_commenting">Commenting</h4>
<div class="paragraph"><p>One helpful technique to avoid stack crashes is to add comments about stack usage.
In this example, we imagine a graphics word "drawbox" that draws a black box.
<code>( color&#8201;&#8212;&#8201;)</code> indicates that it takes one argument on stack, and on exit it should
leave nothing on the stack. The comments inside the word (starting with &pound;) indicate what the stack
looks like after the line has executed.</p></div>
<div class="listingblock">
<div class="content">
<pre><code>: drawbox ( color -- )
10 begin dup 20 &lt; while £ color x
10 begin dup 20 &lt; while £ color x y
2dup £ color x y x y
4 pick £ color x y x y color
blkcol £ color x y
1+ repeat drop £ color x
1+ repeat 2drop ;</code></pre>
</div></div>
<div class="paragraph"><p>Once the word is working as supposed, it may be nice to again remove the comments, as
they are no longer very interesting to read.</p></div>
<div class="paragraph"><p>Note: The Forth standard defines backslash (\) as the line comment character, but the C64 lacks a real backslash. Moreover, ASCII \ and PETSCII &pound; both map to $5c. Therefore, the &pound; character is used as a substitution on the C64.</p></div>
</div>
<div class="sect3">
<h4 id="_stack_checks">Stack Checks</h4>
<div class="paragraph"><p>Another useful technique during development is to check at the end of your main loop
that the stack depth is what you expect it to. This will catch stack underflows
and overflows.</p></div>
<div class="listingblock">
<div class="content">
<pre><code>: mainloop begin
( do stuff here... )
depth abort" depth not 0"
again ;</code></pre>
</div></div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_editor">Editor</h2>
<div class="sectionbody">
<div class="paragraph"><p>The editor is a vi clone. Launch it by entering <code>v foo</code> in the interpreter (<code>foo</code> being the file you want to edit). You can also enter <code>v</code> without argument to create an unnamed buffer. For more info about vi style editing, see <a href="https://www.vim.org">the Vim web site</a>.</p></div>
<div class="sect2">
<h3 id="_inserting_text">Inserting Text</h3>
<div class="paragraph"><p>At startup, the editor is in command mode. These commands start insert mode, which allows you to enter text. Return to command mode with &larr;.</p></div>
<div class="dlist"><dl>
<dt class="hdlist1">
i
</dt>
<dd>
<p>
Insert text.
</p>
</dd>
<dt class="hdlist1">
R
</dt>
<dd>
<p>
Replace text.
</p>
</dd>
<dt class="hdlist1">
a
</dt>
<dd>
<p>
Append text.
</p>
</dd>
<dt class="hdlist1">
A
</dt>
<dd>
<p>
Append text at end of line.
</p>
</dd>
<dt class="hdlist1">
C
</dt>
<dd>
<p>
Change rest of line.
</p>
</dd>
<dt class="hdlist1">
S
</dt>
<dd>
<p>
Substitute line.
</p>
</dd>
<dt class="hdlist1">
s
</dt>
<dd>
<p>
Substitute character.
</p>
</dd>
<dt class="hdlist1">
o
</dt>
<dd>
<p>
Open new line after cursor line.
</p>
</dd>
<dt class="hdlist1">
O
</dt>
<dd>
<p>
Open new line on cursor line.
</p>
</dd>
<dt class="hdlist1">
cw
</dt>
<dd>
<p>
Change word.
</p>
</dd>
</dl></div>
</div>
<div class="sect2">
<h3 id="_navigation">Navigation</h3>
<div class="dlist"><dl>
<dt class="hdlist1">
hjkl <em>or</em> &lArr;&dArr;&uArr;&rArr;
</dt>
<dd>
<p>
Move cursor left, down, up, right.
</p>
</dd>
<dt class="hdlist1">
-
</dt>
<dd>
<p>
Scroll 1 line up.
</p>
</dd>
<dt class="hdlist1">
+
</dt>
<dd>
<p>
Scroll 1 line down.
</p>
</dd>
<dt class="hdlist1">
Ctrl+u
</dt>
<dd>
<p>
Half page up.
</p>
</dd>
<dt class="hdlist1">
Ctrl+d
</dt>
<dd>
<p>
Half page down.
</p>
</dd>
<dt class="hdlist1">
b
</dt>
<dd>
<p>
Go to previous word.
</p>
</dd>
<dt class="hdlist1">
w
</dt>
<dd>
<p>
Go to next word.
</p>
</dd>
<dt class="hdlist1">
e
</dt>
<dd>
<p>
Go to end of word.
</p>
</dd>
<dt class="hdlist1">
fx
</dt>
<dd>
<p>
Find char <code>x</code> forward.
</p>
</dd>
<dt class="hdlist1">
Fx
</dt>
<dd>
<p>
Find char <code>x</code> backward.
</p>
</dd>
<dt class="hdlist1">
0 <em>or</em> Home
</dt>
<dd>
<p>
Go to line start.
</p>
</dd>
<dt class="hdlist1">
$
</dt>
<dd>
<p>
Go to line end.
</p>
</dd>
<dt class="hdlist1">
g
</dt>
<dd>
<p>
Go to start of file.
</p>
</dd>
<dt class="hdlist1">
G
</dt>
<dd>
<p>
Go to end of file.
</p>
</dd>
<dt class="hdlist1">
H
</dt>
<dd>
<p>
Go to home window line.
</p>
</dd>
<dt class="hdlist1">
L
</dt>
<dd>
<p>
Go to last window line.
</p>
</dd>
<dt class="hdlist1">
M
</dt>
<dd>
<p>
Go to middle window line.
</p>
</dd>
<dt class="hdlist1">
</dt>
<dd>
<p>
Search forward for the next occurrence of the string.
</p>
</dd>
<dt class="hdlist1">
*
</dt>
<dd>
<p>
Search forward for the next occurrence of the word under the cursor.
</p>
</dd>
<dt class="hdlist1">
n
</dt>
<dd>
<p>
Repeat the latest search.
</p>
</dd>
</dl></div>
</div>
<div class="sect2">
<h3 id="_saving_and_quitting">Saving and Quitting</h3>
<div class="paragraph"><p>After quitting, the editor can be re-opened by entering <code>v</code>, and it will resume operations with the edit buffer preserved.</p></div>
<div class="dlist"><dl>
<dt class="hdlist1">
ZZ
</dt>
<dd>
<p>
Save and exit.
</p>
</dd>
</dl></div>
<div class="dlist"><dl>
<dt class="hdlist1">
F7
</dt>
<dd>
<p>
Compile and run editor contents. On completion, enter <code>v</code> to return to editor. To terminate a running program, press <em>RESTORE</em>.
</p>
</dd>
</dl></div>
</div>
<div class="sect2">
<h3 id="_text_manipulation">Text Manipulation</h3>
<div class="dlist"><dl>
<dt class="hdlist1">
r
</dt>
<dd>
<p>
Replace character under cursor.
</p>
</dd>
<dt class="hdlist1">
x
</dt>
<dd>
<p>
Delete character.
</p>
</dd>
<dt class="hdlist1">
X
</dt>
<dd>
<p>
Backspace-delete character.
</p>
</dd>
<dt class="hdlist1">
dw
</dt>
<dd>
<p>
Delete word.
</p>
</dd>
<dt class="hdlist1">
dd
</dt>
<dd>
<p>
Cut line.
</p>
</dd>
<dt class="hdlist1">
D
</dt>
<dd>
<p>
Delete rest of line.
</p>
</dd>
<dt class="hdlist1">
yy
</dt>
<dd>
<p>
Yank (copy) line.
</p>
</dd>
<dt class="hdlist1">
p
</dt>
<dd>
<p>
Paste line below cursor position.
</p>
</dd>
<dt class="hdlist1">
P
</dt>
<dd>
<p>
Paste line on cursor position.
</p>
</dd>
<dt class="hdlist1">
J
</dt>
<dd>
<p>
Join lines.
</p>
</dd>
</dl></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_forth_words">Forth Words</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_stack_manipulation">Stack Manipulation</h3>
<div class="dlist"><dl>
<dt class="hdlist1">
drop ( a&#8201;&#8212;&#8201;)
</dt>
<dd>
<p>
Drop top of stack.
</p>
</dd>
<dt class="hdlist1">
dup ( a&#8201;&#8212;&#8201;a a )
</dt>
<dd>
<p>
Duplicate top of stack.
</p>
</dd>
<dt class="hdlist1">
swap ( a b&#8201;&#8212;&#8201;b a )
</dt>
<dd>
<p>
Swap top stack elements.
</p>
</dd>
<dt class="hdlist1">
over ( a b&#8201;&#8212;&#8201;a b a )
</dt>
<dd>
<p>
Make a copy of the second item and push it on top.
</p>
</dd>
<dt class="hdlist1">
rot ( a b c&#8201;&#8212;&#8201;b c a )
</dt>
<dd>
<p>
Rotate the third item to the top.
</p>
</dd>
<dt class="hdlist1">
-rot ( a b c&#8201;&#8212;&#8201;c a b )
</dt>
<dd>
<p>
rot rot
</p>
</dd>
<dt class="hdlist1">
2drop ( a b&#8201;&#8212;&#8201;)
</dt>
<dd>
<p>
Drop two topmost stack elements.
</p>
</dd>
<dt class="hdlist1">
2dup ( a b&#8201;&#8212;&#8201;a b a b )
</dt>
<dd>
<p>
Duplicate two topmost stack elements.
</p>
</dd>
<dt class="hdlist1">
?dup ( a&#8201;&#8212;&#8201;a a? )
</dt>
<dd>
<p>
Dup a if a differs from 0.
</p>
</dd>
<dt class="hdlist1">
nip ( a b&#8201;&#8212;&#8201;b )
</dt>
<dd>
<p>
swap drop
</p>
</dd>
<dt class="hdlist1">
tuck ( a b&#8201;&#8212;&#8201;b a b )
</dt>
<dd>
<p>
dup -rot
</p>
</dd>
<dt class="hdlist1">
pick ( x<sub>u</sub> &#8230; x<sub>1</sub> x<sub>0</sub> u&#8201;&#8212;&#8201;x<sub>u</sub> &#8230; x<sub>1</sub> x<sub>0</sub> x<sub>u</sub> )
</dt>
<dd>
<p>
Pick from stack element with depth u to top of stack.
</p>
</dd>
<dt class="hdlist1">
&gt;r ( a&#8201;&#8212;&#8201;)
</dt>
<dd>
<p>
Move value from top of parameter stack to top of return stack.
</p>
</dd>
<dt class="hdlist1">
r&gt; (&#8201;&#8212;&#8201;a )
</dt>
<dd>
<p>
Move value from top of return stack to top of parameter stack.
</p>
</dd>
<dt class="hdlist1">
r@ (&#8201;&#8212;&#8201;a )
</dt>
<dd>
<p>
Copy value from top of return stack to top of parameter stack.
</p>
</dd>
<dt class="hdlist1">
depth (&#8201;&#8212;&#8201;n)
</dt>
<dd>
<p>
<code>n</code> is the number of single-cell values contained in the data stack before <code>n</code> was placed on the stack.
</p>
</dd>
<dt class="hdlist1">
lsb (&#8201;&#8212;&#8201;addr)
</dt>
<dd>
<p>
The top address of the LSB parameter stack.
</p>
</dd>
<dt class="hdlist1">
msb (&#8201;&#8212;&#8201;addr)
</dt>
<dd>
<p>
The top address of the MSB parameter stack.
</p>
</dd>
</dl></div>
</div>
<div class="sect2">
<h3 id="_utility">Utility</h3>
<div class="dlist"><dl>
<dt class="hdlist1">
. ( n&#8201;&#8212;&#8201;)
</dt>
<dd>
<p>
Prints top value of stack as signed number.
</p>
</dd>
<dt class="hdlist1">
u. ( u&#8201;&#8212;&#8201;)
</dt>
<dd>
<p>
Prints top value of stack as unsigned number.
</p>
</dd>
<dt class="hdlist1">
.s
</dt>
<dd>
<p>
See stack contents.
</p>
</dd>
<dt class="hdlist1">
emit ( a&#8201;&#8212;&#8201;)
</dt>
<dd>
<p>
Prints top value of stack as a PETSCII character. Example: <code>q emit</code>
</p>
</dd>
<dt class="hdlist1">
&pound;
</dt>
<dd>
<p>
Comment to end of line. (Used on C64/PETSCII.)
</p>
</dd>
<dt class="hdlist1">
\
</dt>
<dd>
<p>
Comment to end of line. (Used when cross-compiling from PC/ASCII.)
</p>
</dd>
<dt class="hdlist1">
(
</dt>
<dd>
<p>
Multiline comment. Ignores everything until a ).
</p>
</dd>
<dt class="hdlist1">
bl (&#8201;&#8212;&#8201;char )
</dt>
<dd>
<p>
Gives the PETSCII character for a space.
</p>
</dd>
<dt class="hdlist1">
space
</dt>
<dd>
<p>
Displays one space.
</p>
</dd>
<dt class="hdlist1">
spaces ( n&#8201;&#8212;&#8201;)
</dt>
<dd>
<p>
Displays n spaces.
</p>
</dd>
<dt class="hdlist1">
page
</dt>
<dd>
<p>
Clears the screen.
</p>
</dd>
<dt class="hdlist1">
rvs
</dt>
<dd>
<p>
Reverse screen output.
</p>
</dd>
</dl></div>
</div>
<div class="sect2">
<h3 id="_mathematics">Mathematics</h3>
<div class="dlist"><dl>
<dt class="hdlist1">
1+ ( a&#8201;&#8212;&#8201;b )
</dt>
<dd>
<p>
Increase top of stack value by 1.
</p>
</dd>
<dt class="hdlist1">
1- ( a&#8201;&#8212;&#8201;b )
</dt>
<dd>
<p>
Decrease top of stack value by 1.
</p>
</dd>
<dt class="hdlist1">
2+ ( a&#8201;&#8212;&#8201;b )
</dt>
<dd>
<p>
Increase top of stack value by 2.
</p>
</dd>
<dt class="hdlist1">
2* ( a&#8201;&#8212;&#8201;b )
</dt>
<dd>
<p>
Multiply top of stack value by 2.
</p>
</dd>
<dt class="hdlist1">
2/ ( a&#8201;&#8212;&#8201;b )
</dt>
<dd>
<p>
Divide top of stack value by 2.
</p>
</dd>
<dt class="hdlist1">
100/ ( a&#8201;&#8212;&#8201;b )
</dt>
<dd>
<p>
Divides top of stack value by $100.
</p>
</dd>
<dt class="hdlist1">
<code>+!</code> ( n a&#8201;&#8212;&#8201;)
</dt>
<dd>
<p>
Add n to memory address a.
</p>
</dd>
<dt class="hdlist1">
+ ( a b&#8201;&#8212;&#8201;c )
</dt>
<dd>
<p>
Add a and b.
</p>
</dd>
<dt class="hdlist1">
- ( a b&#8201;&#8212;&#8201;c )
</dt>
<dd>
<p>
Subtract b from a.
</p>
</dd>
<dt class="hdlist1">
* ( a b&#8201;&#8212;&#8201;c )
</dt>
<dd>
<p>
Multiply a with b.
</p>
</dd>
<dt class="hdlist1">
/ ( a b&#8201;&#8212;&#8201;q )
</dt>
<dd>
<p>
Divide a with b using floored division.
</p>
</dd>
<dt class="hdlist1">
/mod ( a b&#8201;&#8212;&#8201;r q )
</dt>
<dd>
<p>
Divide a with b, giving remainder r and quotient q.
</p>
</dd>
<dt class="hdlist1">
mod ( a b&#8201;&#8212;&#8201;r )
</dt>
<dd>
<p>
Remainder of a divided by b.
</p>
</dd>
<dt class="hdlist1">
*/ ( a b c&#8201;&#8212;&#8201;q )
</dt>
<dd>
<p>
Multiply a with b, then divide by c, using a 32-bit intermediary.
</p>
</dd>
<dt class="hdlist1">
*/mod ( a b c&#8201;&#8212;&#8201;r q )
</dt>
<dd>
<p>
Like */, but also keeping remainder r.
</p>
</dd>
<dt class="hdlist1">
0&lt; ( a&#8201;&#8212;&#8201;b )
</dt>
<dd>
<p>
Is a negative?
</p>
</dd>
<dt class="hdlist1">
negate ( a&#8201;&#8212;&#8201;b )
</dt>
<dd>
<p>
Negates a.
</p>
</dd>
<dt class="hdlist1">
abs ( a&#8201;&#8212;&#8201;b )
</dt>
<dd>
<p>
Gives absolute value of a.
</p>
</dd>
<dt class="hdlist1">
min ( a b&#8201;&#8212;&#8201;c )
</dt>
<dd>
<p>
Gives the lesser of a and b.
</p>
</dd>
<dt class="hdlist1">
max ( a b&#8201;&#8212;&#8201;c )
</dt>
<dd>
<p>
Gives the greater of a and b.
</p>
</dd>
<dt class="hdlist1">
within ( n lo hi&#8201;&#8212;&#8201;flag )
</dt>
<dd>
<p>
Returns true if lo &leq; n &lt; hi.
</p>
</dd>
<dt class="hdlist1">
&lt; ( n1 n2&#8201;&#8212;&#8201;flag )
</dt>
<dd>
<p>
Is n1 less than n2? (Signed.)
</p>
</dd>
<dt class="hdlist1">
&gt; ( n1 n2&#8201;&#8212;&#8201;flag )
</dt>
<dd>
<p>
Is n1 greater than n2? (Signed.)
</p>
</dd>
<dt class="hdlist1">
u&lt; ( u1 u2&#8201;&#8212;&#8201;flag )
</dt>
<dd>
<p>
Is u1 less than u2? (Unsigned.)
</p>
</dd>
<dt class="hdlist1">
u&gt; ( u1 u2&#8201;&#8212;&#8201;flag )
</dt>
<dd>
<p>
Is u1 greater than u2? (Unsigned.)
</p>
</dd>
<dt class="hdlist1">
lshift ( a b&#8201;&#8212;&#8201;c )
</dt>
<dd>
<p>
Binary shift a left by b.
</p>
</dd>
<dt class="hdlist1">
rshift ( a b&#8201;&#8212;&#8201;c )
</dt>
<dd>
<p>
Binary shift a right by b.
</p>
</dd>
<dt class="hdlist1">
base (variable)
</dt>
<dd>
<p>
Points to the cell that holds the numerical base.
</p>
</dd>
<dt class="hdlist1">
decimal
</dt>
<dd>
<p>
Sets the numerical base to 10.
</p>
</dd>
<dt class="hdlist1">
hex
</dt>
<dd>
<p>
Sets the numerical base to 16.
</p>
</dd>
</dl></div>
</div>
<div class="sect2">
<h3 id="_double">Double</h3>
<div class="paragraph"><p>The following words use double-cell integers. On the stack, the cell containing the most significant part of a double-cell integer is above the cell containing the least significant part.</p></div>
<div class="dlist"><dl>
<dt class="hdlist1">
dabs <em>( d&#8201;&#8212;&#8201;ud )</em>
</dt>
<dd>
<p>
Produces the absolute value of <em>d</em>.
</p>
</dd>
<dt class="hdlist1">
dnegate <em>( d&#8201;&#8212;&#8201;d )</em>
</dt>
<dd>
<p>
Negates the double-cell integer <em>d</em>.
</p>
</dd>
<dt class="hdlist1">
s&gt;d <em>( n&#8201;&#8212;&#8201;d )</em>
</dt>
<dd>
<p>
Converts the number n to the double-cell number <em>d</em>.
</p>
</dd>
<dt class="hdlist1">
m+ <em>( d n&#8201;&#8212;&#8201;d )</em>
</dt>
<dd>
<p>
Add <em>n</em> to double-cell number <em>d</em>.
</p>
</dd>
<dt class="hdlist1">
m* <em>( a b&#8201;&#8212;&#8201;d )</em>
</dt>
<dd>
<p>
Multiply <em>a</em> with <em>b</em>, producing a double-cell value.
</p>
</dd>
<dt class="hdlist1">
um* <em>( a b&#8201;&#8212;&#8201;ud )</em>
</dt>
<dd>
<p>
Multiply <em>a</em> with <em>b</em>, giving the unsigned double-cell number <em>ud</em>.
</p>
</dd>
<dt class="hdlist1">
um/mod <em>( ud n&#8201;&#8212;&#8201;r q )</em>
</dt>
<dd>
<p>
Divide double-cell number ud by n, giving remainder r and quotient q. Values are unsigned.
</p>
</dd>
<dt class="hdlist1">
fm/mod <em>( d n&#8201;&#8212;&#8201;r q )</em>
</dt>
<dd>
<p>
Divide double-cell number d by n, giving the floored quotient q and the remainder r. Values are signed.
</p>
</dd>
</dl></div>
</div>
<div class="sect2">
<h3 id="_logic">Logic</h3>
<div class="dlist"><dl>
<dt class="hdlist1">
0= <em>( a&#8201;&#8212;&#8201;flag)</em>
</dt>
<dd>
<p>
Is <em>a</em> equal to zero?
</p>
</dd>
<dt class="hdlist1">
0&lt;&gt; <em>( a&#8201;&#8212;&#8201;flag )</em>
</dt>
<dd>
<p>
Is <em>a</em> not equal to 0?
</p>
</dd>
<dt class="hdlist1">
\= <em>( a b&#8201;&#8212;&#8201;flag )</em>
</dt>
<dd>
<p>
Is <em>a</em> equal to <em>b</em>?
</p>
</dd>
<dt class="hdlist1">
&lt;&gt; <em>( a b&#8201;&#8212;&#8201;flag )</em>
</dt>
<dd>
<p>
Does <em>a</em> differ from <em>b</em>?
</p>
</dd>
<dt class="hdlist1">
and <em>( a b&#8201;&#8212;&#8201;c )</em>
</dt>
<dd>
<p>
Binary and.
</p>
</dd>
<dt class="hdlist1">
or <em>( a b&#8201;&#8212;&#8201;c )</em>
</dt>
<dd>
<p>
Binary or.
</p>
</dd>
<dt class="hdlist1">
xor <em>( a b&#8201;&#8212;&#8201;c )</em>
</dt>
<dd>
<p>
Binary exclusive or.
</p>
</dd>
<dt class="hdlist1">
invert <em>( a&#8201;&#8212;&#8201;b )</em>
</dt>
<dd>
<p>
Flip all bits of <em>a</em>.
</p>
</dd>
</dl></div>
</div>
<div class="sect2">
<h3 id="_memory">Memory</h3>
<div class="dlist"><dl>
<dt class="hdlist1">
! <em>( value address&#8201;&#8212;&#8201;)</em>
</dt>
<dd>
<p>
Store 16-bit value at address.
</p>
</dd>
<dt class="hdlist1">
@ <em>( address&#8201;&#8212;&#8201;value )</em>
</dt>
<dd>
<p>
Fetch 16-bit value from address.
</p>
</dd>
<dt class="hdlist1">
c! <em>( value address&#8201;&#8212;&#8201;)</em>
</dt>
<dd>
<p>
Store 8-bit value at address.
</p>
</dd>
<dt class="hdlist1">
c@ <em>( address&#8201;&#8212;&#8201;value )</em>
</dt>
<dd>
<p>
Fetch 8-bit value from address.
</p>
</dd>
<dt class="hdlist1">
fill <em>( addr len char&#8201;&#8212;&#8201;)</em>
</dt>
<dd>
<p>
Fill range [addr, len + addr) with char.
</p>
</dd>
<dt class="hdlist1">
move <em>( src dst len&#8201;&#8212;&#8201;)</em>
</dt>
<dd>
<p>
Copies a region of memory <code>len</code> bytes long, starting at <code>src</code>, to memory beginning at <code>dst</code>.
</p>
</dd>
</dl></div>
</div>
<div class="sect2">
<h3 id="_compiling">Compiling</h3>
<div class="dlist"><dl>
<dt class="hdlist1">
: <em>( "&lt;spaces&gt;name"&#8201;&#8212;&#8201;)</em>
</dt>
<dd>
<p>
Define the word with the given name and enter compilation state.
</p>
</dd>
</dl></div>
<div class="dlist"><dl>
<dt class="hdlist1">
; <em>(&#8201;&#8212;&#8201;)</em>
</dt>
<dd>
<p>
End the current definition, allow it to be found in the dictionary and go back to interpretation state.
</p>
</dd>
<dt class="hdlist1">
code <em>( "&lt;spaces&gt;name"&#8201;&#8212;&#8201;)</em>
</dt>
<dd>
<p>
Start assembling a new word.
</p>
</dd>
<dt class="hdlist1">
;code
</dt>
<dd>
<p>
End assembler.
</p>
</dd>
<dt class="hdlist1">
, <em>( n&#8201;&#8212;&#8201;)</em>
</dt>
<dd>
<p>
Write word on stack to <code>here</code> position and increase <code>here</code> by 2.
</p>
</dd>
<dt class="hdlist1">
c, <em>( n&#8201;&#8212;&#8201;)</em>
</dt>
<dd>
<p>
Write byte on stack to <code>here</code> position and increase <code>here</code> by 1.
</p>
</dd>
<dt class="hdlist1">
allot <em>( n&#8201;&#8212;&#8201;)</em>
</dt>
<dd>
<p>
Add <em>n</em> bytes to the body of the most recently defined word.
</p>
</dd>
<dt class="hdlist1">
literal <em>( n&#8201;&#8212;&#8201;)</em>
</dt>
<dd>
<p>
Compile a value from the stack as a literal value. Typical use: <code>: x ... [ a b * ] literal ... ;</code>
</p>
</dd>
<dt class="hdlist1">
[char] <em>( "&lt;spaces&gt;c"&#8201;&#8212;&#8201;)</em>
</dt>
<dd>
<p>
Compile character <em>c</em> as a literal value.
</p>
</dd>
<dt class="hdlist1">
[ <em>(&#8201;&#8212;&#8201;)</em>
</dt>
<dd>
<p>
Leave compile mode. Execute the following words immediately instead of compiling them.
</p>
</dd>
<dt class="hdlist1">
] <em>(&#8201;&#8212;&#8201;)</em>
</dt>
<dd>
<p>
Return to compile mode.
</p>
</dd>
<dt class="hdlist1">
immediate
</dt>
<dd>
<p>
Mark the most recently defined word as immediate (i.e. inside colon definitions, it will be executed immediately instead of compiled).
</p>
</dd>
<dt class="hdlist1">
['] name <em>(&#8201;&#8212;&#8201;xt )</em>
</dt>
<dd>
<p>
Place name&#8217;s execution token xt on the stack.
The execution token returned by the compiled phrase <code>['] x</code> is the same value returned by <code>' x</code> outside of compilation state.
Typical use: <code>: x &#8230; ['] name &#8230; ;</code>
</p>
</dd>
<dt class="hdlist1">
compile, ( xt&#8201;&#8212;&#8201;)
</dt>
<dd>
<p>
Append \texttt{jsr xt} to the word being compiled. Typical use: <code>: recurse immed latest &gt;xt compile, ;</code>
</p>
</dd>
<dt class="hdlist1">
postpone <em>xxx</em>
</dt>
<dd>
<p>
Compile the compilation semantics (instead of interpretation semantics) of xxx. Typical use:
</p>
</dd>
</dl></div>
<div class="listingblock">
<div class="content">
<pre><code>: endif postpone then ; immediate
: x ... if ... endif ... ;</code></pre>
</div></div>
<div class="dlist"><dl>
<dt class="hdlist1">
header <em>xxx</em>
</dt>
<dd>
<p>
Create a dictionary header with name <code>xxx</code>.
</p>
</dd>
<dt class="hdlist1">
create <em>xxx</em> &#8230; does&gt;
</dt>
<dd>
<p>
Create a word creating word <code>xxx</code> with custom behavior specified after <code>does&gt;</code>.
For further description, see "Starting Forth."
</p>
</dd>
<dt class="hdlist1">
state <em>(&#8201;&#8212;&#8201;addr)</em>
</dt>
<dd>
<p>
<em>addr</em> is the address of a cell containing the compilation-state flag.
It is 1 when compiling, otherwise 0.
</p>
</dd>
</dl></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_configuring_durexforth">Configuring durexForth</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_stripping_modules">Stripping Modules</h3>
<div class="paragraph"><p>By default, durexForth boots up with these modules pre-compiled in RAM:</p></div>
<div class="dlist"><dl>
<dt class="hdlist1">
asm
</dt>
<dd>
<p>
The assembler. (Required and may not be stripped.)
</p>
</dd>
<dt class="hdlist1">
format
</dt>
<dd>
<p>
Numerical formatting words. (Also required.)
</p>
</dd>
<dt class="hdlist1">
wordlist
</dt>
<dd>
<p>
Wordlist manipulation. (Required by some modules.)
</p>
</dd>
<dt class="hdlist1">
labels
</dt>
<dd>
<p>
Assembler labels.
</p>
</dd>
<dt class="hdlist1">
doloop
</dt>
<dd>
<p>
Do-loop words.
</p>
</dd>
<dt class="hdlist1">
sys
</dt>
<dd>
<p>
System calls.
</p>
</dd>
<dt class="hdlist1">
debug
</dt>
<dd>
<p>
Words for debugging.
</p>
</dd>
<dt class="hdlist1">
ls
</dt>
<dd>
<p>
List disk contents.
</p>
</dd>
<dt class="hdlist1">
require
</dt>
<dd>
<p>
The words require and required.
</p>
</dd>
<dt class="hdlist1">
v
</dt>
<dd>
<p>
The text editor.
</p>
</dd>
</dl></div>
<div class="paragraph"><p>To reduce RAM usage, you may make a stripped-down version of durexForth. Do this by following these steps:</p></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
Issue <code>---modules---</code> to unload all modules, or <code>---editor---</code> to unload the editor only.
</p>
</li>
<li>
<p>
One by one, load the modules you want included with your new Forth. (E.g. <code>include labels</code>)
</p>
</li>
<li>
<p>
Save the new system with e.g. <code>save-forth acmeforth</code>.
</p>
</li>
</ol></div>
</div>
<div class="sect2">
<h3 id="_custom_start_up">Custom Start-Up</h3>
<div class="paragraph"><p>You may launch a word automatically at start-up by setting the variable <code>start</code> to the execution token of the word.  Example: <code>' megademo start !</code> To save the new configuration to disk, type e.g. <code>save-forth megademo</code>.</p></div>
<div class="paragraph"><p>When writing a new program using a PC text editor, it is practical to configure durexForth to compile and execute the program at startup. That can be set up using the following snippet:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$a000 value buf
: go buf s" myprogramfile" buf
loadb buf - evaluate ;
' go start !
save-forth @0:durexforth</code></pre>
</div></div>
</div>
<div class="sect2">
<h3 id="_turn_key_operation">Turn-key Operation</h3>
<div class="paragraph"><p>Durexforth offers utilities to save your program in a turn-key fashion by including the <code>turnkey</code> module once the program is ready to be saved.</p></div>
<div class="paragraph"><p>Programs can be saved in a compacted state using <code>save-pack</code>. These programs are stored with 32 bytes between <code>here</code> and <code>latest</code>. When they are first loaded, they will restore the header space to its original <code>top</code>.</p></div>
<div class="paragraph"><p>If you have developed a program that has no further need of the interpreter, you can eliminate the dictionary headers entirely when saving with <code>save-prg</code>. This allows your program to use memory down to <code>here</code> plus 32 bytes for safety.</p></div>
<div class="paragraph"><p>After either of these words have saved the file to disk, they will restore forth to the unpacked state, and strip the <code>turnkey</code> module from the dictionary. This allows you to continue to use forth interactively in the case of <code>save-pack</code>. As <code>save-prg</code> has stripped the dictionary headers from the system, it will no longer be usable. If you wish to test your program after saving, you can compile a call to <code>save-prg</code> instead:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>: build save-prg mydemo start @ execute ;
build</code></pre>
</div></div>
<div class="paragraph"><p>This will simulate the start-up sequence after saving the packed program.</p></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_internet_resources">Appendix A: Internet Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_books_and_papers">Books and Papers</h3>
<div class="ulist"><ul>
<li>
<p>
<a href="https://www.forth.com/starting-forth/">Starting Forth</a>
</p>
</li>
<li>
<p>
<a href="http://thinking-forth.sourceforge.net/">Thinking Forth</a>
</p>
</li>
<li>
<p>
<a href="https://www.bradrodriguez.com/papers/">Moving Forth: a series on writing Forth kernels</a>
</p>
</li>
<li>
<p>
<a href="http://forth.org/">Forth Interest Group</a>
</p>
</li>
<li>
<p>
<a href="https://archive.org/details/transactor-magazines-v7-i05/page/n59/mode/2up">Blazin' Forth --- An inside look at the Blazin' Forth compiler</a>
</p>
</li>
<li>
<p>
<a href="https://www.drdobbs.com/architecture-and-design/the-evolution-of-forth-an-unusual-langua/228700557">The Evolution of FORTH, an unusual language</a>
</p>
</li>
<li>
<p>
<a href="https://galileo.phys.virginia.edu/classes/551.jvn.fall01/primer.htm">A Beginner&#8217;s Guide to Forth</a>
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_other_forths">Other Forths</h3>
<div class="ulist"><ul>
<li>
<p>
<a href="https://colorforth.github.io/">colorForth</a>
</p>
</li>
<li>
<p>
<a href="https://gforth.org/">Gforth</a>
</p>
</li>
<li>
<p>
<a href="https://github.com/nornagon/jonesforth">jonesforth</a>
</p>
</li>
<li>
<p>
<a href="https://github.com/chitselb/pettil">PETTIL</a>
</p>
</li>
<li>
<p>
<a href="https://github.com/forth-ev/VolksForth">volksFORTH</a>
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_standards">Standards</h3>
<div class="ulist"><ul>
<li>
<p>
<a href="https://forth-standard.org/">Forth 2012 Standard</a>
</p>
</li>
<li>
<p>
<a href="https://www.taygeta.com/forth/dpans.html">ANS Forth</a>
</p>
</li>
<li>
<p>
<a href="http://forth.sourceforge.net/standard/fst83/">FORTH-83 STANDARD</a>
</p>
</li>
<li>
<p>
<a href="https://atariwiki.org/wiki/attach/Forth79/Forth-79-OCR.pdf">FORTH-79 STANDARD</a>
</p>
</li>
</ul></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_authors_and_contributors">Appendix B: Authors and Contributors</h2>
<div class="sectionbody">
<div class="dlist"><dl>
<dt class="hdlist1">
Johan Kotlinski
</dt>
<dd>
<p>
Project initiator and maintainer.
</p>
</dd>
<dt class="hdlist1">
Mats Andr&eacute;n
</dt>
<dd>
<p>
Contributed disk I/O primitives.
</p>
</dd>
</dl></div>
<div class="paragraph"><p><em>This list is incomplete.</em></p></div>
</div>
</div>
<div class="sect1">
<h2 id="_license">Appendix C: License</h2>
<div class="sectionbody">
<div class="paragraph"><p>The MIT License</p></div>
<div class="paragraph"><p>Copyright &copy; 2008 Johan Kotlinski</p></div>
<div class="paragraph"><p>Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:</p></div>
<div class="paragraph"><p>The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.</p></div>
<div class="paragraph"><p>THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.</p></div>
</div>
</div>
</div>
<div id="footnotes"><hr /></div>
<div id="footer">
<div id="footer-text">
Last updated
 2022-08-18 00:56:18 CEST
</div>
</div>
</body>
</html>
